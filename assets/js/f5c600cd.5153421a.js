"use strict";(globalThis.webpackChunkbrowser_dashboard_pwa_docs=globalThis.webpackChunkbrowser_dashboard_pwa_docs||[]).push([[3202],{1487:(e,n,s)=>{s.d(n,{A:()=>t});const i={reqStatus:"reqStatus_It10",reqStatusDraft:"reqStatusDraft_r86d",reqStatusReady:"reqStatusReady_vlST",reqStatusDone:"reqStatusDone_Fh10",reqStatusReleased:"reqStatusReleased_cVtA"};var r=s(7259);function t(e){return(0,r.jsx)("span",{className:(n=e.status,i.reqStatus+" "+i[`reqStatus${n}`]),children:e.status||"-"});var n}},3024:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>h,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>x});const i=JSON.parse('{"id":"requirements/functional/synchronization","title":"Synchronization","description":"Overview","source":"@site/docs/requirements/functional/synchronization.mdx","sourceDirName":"requirements/functional","slug":"/requirements/functional/synchronization","permalink":"/browser-dashboard-pwa/docs/requirements/functional/synchronization","draft":false,"unlisted":false,"editUrl":"https://github.com/migmolrod/browser-dashboard-pwa/tree/master/docs/docs/requirements/functional/synchronization.mdx","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9,"title":"Synchronization","status":"Draft","lastUpdated":"2025-11-15T00:00:00.000Z"},"sidebar":"requirements","previous":{"title":"Preferences","permalink":"/browser-dashboard-pwa/docs/requirements/functional/preferences"},"next":{"title":"Non-Functional requirements","permalink":"/browser-dashboard-pwa/docs/requirements/non-functional-requirements"}}');var r=s(7259),t=s(5739),l=s(4761),o=s(6453),c=s(1487);const a={sidebar_position:9,title:"Synchronization",status:"Draft",lastUpdated:new Date("2025-11-15T00:00:00.000Z")},d="Synchronization",h={},x=[{value:"Overview",id:"overview",level:2},{value:"Features",id:"features",level:2},{value:"Summary",id:"summary",level:3},{value:"FR-SYN-001: Local persistence",id:"fr-syn-001-local-persistence",level:3},{value:"Scenarios",id:"scenarios",level:4},{value:"Scenario 1: Persist data locally on creation (happy path)",id:"scenario-1-persist-data-locally-on-creation-happy-path",level:5},{value:"Scenario 2: Retrieve data from local storage",id:"scenario-2-retrieve-data-from-local-storage",level:5},{value:"Scenario 3: Local data persists across sessions",id:"scenario-3-local-data-persists-across-sessions",level:5},{value:"Scenario 4: Handle storage quota limits",id:"scenario-4-handle-storage-quota-limits",level:5},{value:"Scenario 5: Encrypt sensitive data in local storage",id:"scenario-5-encrypt-sensitive-data-in-local-storage",level:5},{value:"Scenario 6: Query local data efficiently",id:"scenario-6-query-local-data-efficiently",level:5},{value:"FR-SYN-002: Offline operation",id:"fr-syn-002-offline-operation",level:3},{value:"Scenarios",id:"scenarios-1",level:4},{value:"Scenario 1: Create data offline (happy path)",id:"scenario-1-create-data-offline-happy-path",level:5},{value:"Scenario 2: Update data offline",id:"scenario-2-update-data-offline",level:5},{value:"Scenario 3: Delete data offline",id:"scenario-3-delete-data-offline",level:5},{value:"Scenario 4: View offline indicator",id:"scenario-4-view-offline-indicator",level:5},{value:"Scenario 5: Multiple offline operations",id:"scenario-5-multiple-offline-operations",level:5},{value:"Scenario 6: Offline operations persist across sessions",id:"scenario-6-offline-operations-persist-across-sessions",level:5},{value:"FR-SYN-003: Background synchronization",id:"fr-syn-003-background-synchronization",level:3},{value:"Scenarios",id:"scenarios-2",level:4},{value:"Scenario 1: Auto-sync on network reconnection (happy path)",id:"scenario-1-auto-sync-on-network-reconnection-happy-path",level:5},{value:"Scenario 2: Periodic background sync",id:"scenario-2-periodic-background-sync",level:5},{value:"Scenario 3: Manual sync trigger",id:"scenario-3-manual-sync-trigger",level:5},{value:"Scenario 4: View sync progress",id:"scenario-4-view-sync-progress",level:5},{value:"Scenario 5: Sync pulls server changes",id:"scenario-5-sync-pulls-server-changes",level:5},{value:"Scenario 6: Partial sync success",id:"scenario-6-partial-sync-success",level:5},{value:"FR-SYN-004: Conflict detection",id:"fr-syn-004-conflict-detection",level:3},{value:"Scenarios",id:"scenarios-3",level:4},{value:"Scenario 1: Detect conflict during sync (happy path)",id:"scenario-1-detect-conflict-during-sync-happy-path",level:5},{value:"Scenario 2: No conflict detected",id:"scenario-2-no-conflict-detected",level:5},{value:"Scenario 3: Log conflict details",id:"scenario-3-log-conflict-details",level:5},{value:"Scenario 4: Notify user of conflict",id:"scenario-4-notify-user-of-conflict",level:5},{value:"Scenario 5: Multiple conflicts",id:"scenario-5-multiple-conflicts",level:5},{value:"FR-SYN-005: Conflict resolution",id:"fr-syn-005-conflict-resolution",level:3},{value:"Scenarios",id:"scenarios-4",level:4},{value:"Scenario 1: Resolve conflict with last-write-wins (happy path)",id:"scenario-1-resolve-conflict-with-last-write-wins-happy-path",level:5},{value:"Scenario 2: Resolve conflict - local wins",id:"scenario-2-resolve-conflict---local-wins",level:5},{value:"Scenario 3: Notify user of resolution",id:"scenario-3-notify-user-of-resolution",level:5},{value:"Scenario 4: Log losing entity",id:"scenario-4-log-losing-entity",level:5},{value:"Scenario 5: Multiple conflict resolutions",id:"scenario-5-multiple-conflict-resolutions",level:5},{value:"FR-SYN-006: Sync status tracking",id:"fr-syn-006-sync-status-tracking",level:3},{value:"Scenarios",id:"scenarios-5",level:4},{value:"Scenario 1: View pending operations count (happy path)",id:"scenario-1-view-pending-operations-count-happy-path",level:5},{value:"Scenario 2: View last sync time",id:"scenario-2-view-last-sync-time",level:5},{value:"Scenario 3: View sync progress",id:"scenario-3-view-sync-progress",level:5},{value:"Scenario 4: View sync errors",id:"scenario-4-view-sync-errors",level:5},{value:"Scenario 5: Query detailed sync status",id:"scenario-5-query-detailed-sync-status",level:5},{value:"Scenario 6: Real-time status updates",id:"scenario-6-real-time-status-updates",level:5},{value:"FR-SYN-007: Retry and error handling",id:"fr-syn-007-retry-and-error-handling",level:3},{value:"Scenarios",id:"scenarios-6",level:4},{value:"Scenario 1: Auto-retry failed operation (happy path)",id:"scenario-1-auto-retry-failed-operation-happy-path",level:5},{value:"Scenario 2: Exponential backoff",id:"scenario-2-exponential-backoff",level:5},{value:"Scenario 3: Manual retry",id:"scenario-3-manual-retry",level:5},{value:"Scenario 4: Persistent failure notification",id:"scenario-4-persistent-failure-notification",level:5},{value:"Scenario 5: Different error types",id:"scenario-5-different-error-types",level:5},{value:"Scenario 6: Error logging",id:"scenario-6-error-logging",level:5},{value:"Cross-feature considerations",id:"cross-feature-considerations",level:2},{value:"Interactions between features",id:"interactions-between-features",level:3},{value:"Shared business rules",id:"shared-business-rules",level:3},{value:"Data consistency requirements",id:"data-consistency-requirements",level:3},{value:"Business constraints impact",id:"business-constraints-impact",level:2},{value:"BC-001: Budget",id:"bc-001-budget",level:3},{value:"BC-002: Timeline",id:"bc-002-timeline",level:3},{value:"BC-003: Resources",id:"bc-003-resources",level:3},{value:"BC-004: Technology stack",id:"bc-004-technology-stack",level:3},{value:"Success metrics alignment",id:"success-metrics-alignment",level:2},{value:"BR-003: Technical metrics",id:"br-003-technical-metrics",level:3},{value:"BR-001: Portfolio quality metrics",id:"br-001-portfolio-quality-metrics",level:3},{value:"BR-002, BR-005: User experience metrics",id:"br-002-br-005-user-experience-metrics",level:3},{value:"Traceability matrix",id:"traceability-matrix",level:2}];function j(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.A,{status:a.status,lastUpdated:a.lastUpdated}),"\n",(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"synchronization",children:"Synchronization"})}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"The Synchronization bounded context provides local-first persistence with reliable background synchronization to\noptional cloud storage. It enables offline-first functionality where users can work without internet connectivity and\nhave their changes synchronized when the connection is restored. The context handles conflict detection and resolution\nusing pluggable strategies."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Bounded context code:"})," SYN",(0,r.jsx)(n.br,{}),"\n",(0,r.jsx)(n.strong,{children:"Related DMD section:"})," ",(0,r.jsx)(n.a,{href:"../../domain/bounded-contexts/synchronization",children:"Synchronization (Generic)"})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,r.jsx)(n.h3,{id:"summary",children:"Summary"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Feature Code"}),(0,r.jsx)(n.th,{children:"Feature Name"}),(0,r.jsx)(n.th,{children:"Priority"}),(0,r.jsx)(n.th,{children:"Status"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-001"}),(0,r.jsx)(n.td,{children:"Local persistence"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(o.A,{priority:"Must Have"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(c.A,{status:"Draft"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-002"}),(0,r.jsx)(n.td,{children:"Offline operation"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(o.A,{priority:"Must Have"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(c.A,{status:"Draft"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-003"}),(0,r.jsx)(n.td,{children:"Background synchronization"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(o.A,{priority:"Must Have"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(c.A,{status:"Draft"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-004"}),(0,r.jsx)(n.td,{children:"Conflict detection"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(o.A,{priority:"Should Have"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(c.A,{status:"Draft"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-005"}),(0,r.jsx)(n.td,{children:"Conflict resolution"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(o.A,{priority:"Should Have"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(c.A,{status:"Draft"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-006"}),(0,r.jsx)(n.td,{children:"Sync status tracking"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(o.A,{priority:"Must Have"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(c.A,{status:"Draft"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-007"}),(0,r.jsx)(n.td,{children:"Retry and error handling"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(o.A,{priority:"Must Have"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(c.A,{status:"Draft"})})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"fr-syn-001-local-persistence",children:"FR-SYN-001: Local persistence"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Priority:"})," ",(0,r.jsx)(o.A,{priority:"Must Have"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),(0,r.jsx)(n.br,{}),"\n","The system must persist all user data locally using browser storage mechanisms (IndexedDB, LocalStorage) to enable\noffline-first functionality. Local persistence ensures data is available immediately without network dependency and\nsurvives browser refreshes."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"User must be authenticated"}),"\n",(0,r.jsx)(n.li,{children:"Browser must support local storage APIs (IndexedDB)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Data is persisted locally in browser storage"}),"\n",(0,r.jsx)(n.li,{children:"Data is available for offline access"}),"\n",(0,r.jsx)(n.li,{children:"Data survives application restarts"}),"\n",(0,r.jsx)(n.li,{children:"Sync metadata is stored alongside data"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All user data is persisted locally by default (offline-first)"}),"\n",(0,r.jsx)(n.li,{children:"Local storage is the primary data source; server is secondary"}),"\n",(0,r.jsx)(n.li,{children:"Each entity has associated sync metadata (version, lastSyncedAt, pendingOps)"}),"\n",(0,r.jsx)(n.li,{children:"Local data takes precedence until synchronized"}),"\n",(0,r.jsx)(n.li,{children:"Storage quota limits are monitored and handled"}),"\n",(0,r.jsx)(n.li,{children:"Sensitive data is encrypted in local storage"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Authenticated User"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-002 (User Productivity Enhancement), BR-003 (Technical\nExcellence), BR-005 (User Value Delivery)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Aggregates: SyncState (root)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Events: All domain events (for local persistence)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All bounded contexts (consumes their domain events)"}),"\n",(0,r.jsx)(n.li,{children:"Browser storage APIs (IndexedDB, LocalStorage)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All domain events are intercepted and persisted locally"}),"\n",(0,r.jsx)(n.li,{children:"Data is stored in IndexedDB with structured schema"}),"\n",(0,r.jsx)(n.li,{children:"Sync metadata (version, timestamp) is stored with each entity"}),"\n",(0,r.jsx)(n.li,{children:"Local data is available immediately without network call"}),"\n",(0,r.jsx)(n.li,{children:"Storage quota is monitored and warnings shown if near limit"}),"\n",(0,r.jsx)(n.li,{children:"Local storage persists across browser refreshes"}),"\n",(0,r.jsx)(n.li,{children:"Encryption is applied to sensitive fields"}),"\n",(0,r.jsx)(n.li,{children:"Local data can be queried efficiently"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"US-SYN-001-001: Persist data locally on creation"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-001-002: Retrieve data from local storage"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-001-003: Local data persists across sessions"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-001-004: Handle storage quota limits"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"scenarios",children:"Scenarios"}),"\n",(0,r.jsx)(n.h5,{id:"scenario-1-persist-data-locally-on-creation-happy-path",children:"Scenario 1: Persist data locally on creation (happy path)"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:['Given a user creates a new task "Buy groceries"',(0,r.jsx)(n.br,{}),"\n","When the TaskCreated event is published",(0,r.jsx)(n.br,{}),"\n","Then the Synchronization context intercepts the event",(0,r.jsx)(n.br,{}),"\n","And stores the task in local IndexedDB",(0,r.jsx)(n.br,{}),"\n",'And creates sync metadata: { version: 1, lastSyncedAt: null, pendingOps: ["create"] }',(0,r.jsx)(n.br,{}),"\n","And the task is immediately available for offline access",(0,r.jsx)(n.br,{}),"\n","And local storage write completes successfully"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-2-retrieve-data-from-local-storage",children:"Scenario 2: Retrieve data from local storage"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a user has tasks stored locally",(0,r.jsx)(n.br,{}),"\n","And the device is offline",(0,r.jsx)(n.br,{}),"\n","When the user opens the tasks view",(0,r.jsx)(n.br,{}),"\n","Then tasks are retrieved from local IndexedDB",(0,r.jsx)(n.br,{}),"\n","And displayed without network call",(0,r.jsx)(n.br,{}),"\n","And the UI indicates offline mode"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-3-local-data-persists-across-sessions",children:"Scenario 3: Local data persists across sessions"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a user has created tasks while offline",(0,r.jsx)(n.br,{}),"\n","When the user closes the browser",(0,r.jsx)(n.br,{}),"\n","And reopens the application later",(0,r.jsx)(n.br,{}),"\n","Then tasks are retrieved from local IndexedDB",(0,r.jsx)(n.br,{}),"\n","And all data is intact",(0,r.jsx)(n.br,{}),"\n","And sync metadata is preserved"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-4-handle-storage-quota-limits",children:"Scenario 4: Handle storage quota limits"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given local storage is approaching quota limit (90% used)",(0,r.jsx)(n.br,{}),"\n","When the user creates new data",(0,r.jsx)(n.br,{}),"\n","Then the system detects near-quota condition",(0,r.jsx)(n.br,{}),"\n",'And displays a warning "Local storage is almost full"',(0,r.jsx)(n.br,{}),"\n","And suggests clearing old data or syncing to cloud",(0,r.jsx)(n.br,{}),"\n","And the operation completes if space is available"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-5-encrypt-sensitive-data-in-local-storage",children:"Scenario 5: Encrypt sensitive data in local storage"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a user's data contains sensitive information (e.g., calendar event details)",(0,r.jsx)(n.br,{}),"\n","When data is persisted to local storage",(0,r.jsx)(n.br,{}),"\n","Then sensitive fields are encrypted using Web Crypto API",(0,r.jsx)(n.br,{}),"\n","And encryption key is derived from user session",(0,r.jsx)(n.br,{}),"\n","And encrypted data is stored in IndexedDB",(0,r.jsx)(n.br,{}),"\n","And can be decrypted when retrieved"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-6-query-local-data-efficiently",children:"Scenario 6: Query local data efficiently"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a user has 1000 tasks stored locally",(0,r.jsx)(n.br,{}),"\n",'When the user searches for "groceries"',(0,r.jsx)(n.br,{}),"\n","Then IndexedDB index is used for efficient lookup",(0,r.jsx)(n.br,{}),"\n","And results are returned in < 100ms",(0,r.jsx)(n.br,{}),"\n","And no network call is made"]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use IndexedDB for structured data storage (primary)"}),"\n",(0,r.jsx)(n.li,{children:"Use LocalStorage for small metadata and settings"}),"\n",(0,r.jsx)(n.li,{children:"Implement structured schema with versioning for IndexedDB"}),"\n",(0,r.jsx)(n.li,{children:"Use IndexedDB indexes for efficient queries (userId, entityType, timestamp)"}),"\n",(0,r.jsx)(n.li,{children:"Implement encryption using Web Crypto API (AES-GCM)"}),"\n",(0,r.jsxs)(n.li,{children:["Monitor storage quota using ",(0,r.jsx)(n.code,{children:"navigator.storage.estimate()"})]}),"\n",(0,r.jsx)(n.li,{children:"Implement storage cleanup strategies (delete old synced data)"}),"\n",(0,r.jsx)(n.li,{children:"Use Dexie.js or similar wrapper for IndexedDB abstraction"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Should there be a maximum local storage age for data (e.g., delete data older than 90 days)?"}),"\n",(0,r.jsx)(n.li,{children:"Should users be able to manually clear local storage?"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"fr-syn-002-offline-operation",children:"FR-SYN-002: Offline operation"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Priority:"})," ",(0,r.jsx)(o.A,{priority:"Must Have"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),(0,r.jsx)(n.br,{}),"\n","The system must support full offline operation where users can create, read, update, and delete data without internet\nconnectivity. Offline operations are queued locally and synchronized when connection is restored. The UI clearly\nindicates offline status."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"User must be authenticated (session cached locally)"}),"\n",(0,r.jsx)(n.li,{children:"Local storage must be available"}),"\n",(0,r.jsx)(n.li,{children:"Application must be loaded (service worker cached)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Operations complete successfully offline"}),"\n",(0,r.jsx)(n.li,{children:"Changes are queued for synchronization"}),"\n",(0,r.jsx)(n.li,{children:"UI indicates offline status"}),"\n",(0,r.jsx)(n.li,{children:"Data is available immediately in local state"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"All CRUD operations work offline"}),"\n",(0,r.jsx)(n.li,{children:"Offline changes are queued with operation metadata (create, update, delete)"}),"\n",(0,r.jsx)(n.li,{children:"Queued operations are ordered by timestamp"}),"\n",(0,r.jsx)(n.li,{children:"Conflicting offline operations are merged locally (last-write-wins within session)"}),"\n",(0,r.jsx)(n.li,{children:"Network status is detected automatically"}),"\n",(0,r.jsx)(n.li,{children:"UI provides clear offline indicators"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Authenticated User"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-002 (User Productivity Enhancement), BR-005 (User Value\nDelivery)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Aggregates: SyncState (root)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Events: All domain events (queued offline)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"FR-SYN-001 (Local persistence)"}),"\n",(0,r.jsx)(n.li,{children:"Service Worker for offline app shell"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"User can create entities while offline"}),"\n",(0,r.jsx)(n.li,{children:"User can update entities while offline"}),"\n",(0,r.jsx)(n.li,{children:"User can delete entities while offline"}),"\n",(0,r.jsx)(n.li,{children:"User can query entities while offline"}),"\n",(0,r.jsx)(n.li,{children:"Offline operations are queued with metadata"}),"\n",(0,r.jsx)(n.li,{children:'UI shows "Offline" badge/indicator'}),"\n",(0,r.jsx)(n.li,{children:"Operations complete without errors or delays"}),"\n",(0,r.jsx)(n.li,{children:"Queued operations persist across sessions"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"US-SYN-002-001: Create data offline"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-002-002: Update data offline"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-002-003: Delete data offline"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-002-004: View offline indicator"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"scenarios-1",children:"Scenarios"}),"\n",(0,r.jsx)(n.h5,{id:"scenario-1-create-data-offline-happy-path",children:"Scenario 1: Create data offline (happy path)"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given the user's device is offline",(0,r.jsx)(n.br,{}),"\n",'And the UI shows "Offline" indicator',(0,r.jsx)(n.br,{}),"\n",'When the user creates a new task "Call dentist"',(0,r.jsx)(n.br,{}),"\n","Then the task is saved to local IndexedDB",(0,r.jsx)(n.br,{}),"\n",'And sync metadata is created: { pendingOps: ["create"], syncStatus: "pending" }',(0,r.jsx)(n.br,{}),"\n","And the task appears in the task list immediately",(0,r.jsx)(n.br,{}),"\n",'And a toast notification shows "Changes will sync when online"']})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-2-update-data-offline",children:"Scenario 2: Update data offline"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given the user's device is offline",(0,r.jsx)(n.br,{}),"\n",'And a task "Buy milk" exists locally',(0,r.jsx)(n.br,{}),"\n",'When the user updates the task to "Buy milk and eggs"',(0,r.jsx)(n.br,{}),"\n","Then the update is saved to local IndexedDB",(0,r.jsx)(n.br,{}),"\n",'And sync metadata is updated: { pendingOps: ["update"], syncStatus: "pending" }',(0,r.jsx)(n.br,{}),"\n","And the updated task displays immediately",(0,r.jsx)(n.br,{}),"\n","And the change is queued for sync"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-3-delete-data-offline",children:"Scenario 3: Delete data offline"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given the user's device is offline",(0,r.jsx)(n.br,{}),"\n",'And a task "Old task" exists locally',(0,r.jsx)(n.br,{}),"\n","When the user deletes the task",(0,r.jsx)(n.br,{}),"\n","Then the task is marked as deleted in local IndexedDB",(0,r.jsx)(n.br,{}),"\n",'And sync metadata is updated: { pendingOps: ["delete"], syncStatus: "pending" }',(0,r.jsx)(n.br,{}),"\n","And the task is removed from the UI",(0,r.jsx)(n.br,{}),"\n","And the deletion is queued for sync"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-4-view-offline-indicator",children:"Scenario 4: View offline indicator"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given the user's device loses internet connection",(0,r.jsx)(n.br,{}),"\n","When the network status changes to offline",(0,r.jsx)(n.br,{}),"\n",'Then an "Offline" badge appears in the UI header',(0,r.jsx)(n.br,{}),"\n",'And a toast notification shows "You\'re offline. Changes will sync automatically"',(0,r.jsx)(n.br,{}),"\n","And all UI interactions remain functional"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-5-multiple-offline-operations",children:"Scenario 5: Multiple offline operations"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given the user's device is offline",(0,r.jsx)(n.br,{}),"\n","When the user creates 3 tasks",(0,r.jsx)(n.br,{}),"\n","And updates 2 existing tasks",(0,r.jsx)(n.br,{}),"\n","And deletes 1 task",(0,r.jsx)(n.br,{}),"\n","Then all 6 operations are queued locally",(0,r.jsx)(n.br,{}),"\n","And each has sync metadata with operation type and timestamp",(0,r.jsx)(n.br,{}),"\n","And all changes are visible in the UI",(0,r.jsx)(n.br,{}),"\n","And operations are ordered by timestamp for sync"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-6-offline-operations-persist-across-sessions",children:"Scenario 6: Offline operations persist across sessions"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given the user made changes while offline",(0,r.jsx)(n.br,{}),"\n","And queued operations exist",(0,r.jsx)(n.br,{}),"\n","When the user closes the browser",(0,r.jsx)(n.br,{}),"\n","And reopens the application (still offline)",(0,r.jsx)(n.br,{}),"\n","Then queued operations are loaded from IndexedDB",(0,r.jsx)(n.br,{}),"\n","And the UI shows pending sync count",(0,r.jsx)(n.br,{}),"\n","And operations remain queued until online"]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"navigator.onLine"})," and online/offline event listeners for network detection"]}),"\n",(0,r.jsx)(n.li,{children:"Implement operation queue in IndexedDB with FIFO ordering"}),"\n",(0,r.jsx)(n.li,{children:"Store operation metadata: { type, entityId, payload, timestamp, userId }"}),"\n",(0,r.jsx)(n.li,{children:"Use optimistic UI updates (show changes immediately)"}),"\n",(0,r.jsx)(n.li,{children:"Implement UI indicators (badge, banner, icon) for offline status"}),"\n",(0,r.jsx)(n.li,{children:"Ensure service worker caches app shell for offline loading"}),"\n",(0,r.jsx)(n.li,{children:"Handle authentication expiration during offline periods"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Should there be a maximum size for the offline operation queue?"}),"\n",(0,r.jsx)(n.li,{children:"Should users be warned if they've been offline for extended periods?"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"fr-syn-003-background-synchronization",children:"FR-SYN-003: Background synchronization"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Priority:"})," ",(0,r.jsx)(o.A,{priority:"Must Have"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),(0,r.jsx)(n.br,{}),"\n","The system must automatically synchronize local changes to the cloud when internet connectivity is available.\nSynchronization occurs in the background without blocking user interactions. Sync is triggered on network reconnection,\nperiodic intervals, and user-initiated refresh."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"User must be authenticated"}),"\n",(0,r.jsx)(n.li,{children:"Internet connection must be available"}),"\n",(0,r.jsx)(n.li,{children:"Local changes must exist (pending operations)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Pending operations are sent to server"}),"\n",(0,r.jsx)(n.li,{children:"Server responses are processed"}),"\n",(0,r.jsx)(n.li,{children:"Local sync state is updated"}),"\n",(0,r.jsx)(n.li,{children:"DataSynchronized event is published"}),"\n",(0,r.jsx)(n.li,{children:"UI indicates sync completion"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sync occurs automatically when online"}),"\n",(0,r.jsx)(n.li,{children:"Sync is triggered by: network reconnection, periodic intervals (e.g., every 5 minutes), user-initiated refresh"}),"\n",(0,r.jsx)(n.li,{children:"Operations are synced in order (FIFO)"}),"\n",(0,r.jsx)(n.li,{children:"Successful operations are marked as synced"}),"\n",(0,r.jsx)(n.li,{children:"Failed operations are retried with exponential backoff"}),"\n",(0,r.jsx)(n.li,{children:"Sync does not block UI interactions"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Authenticated User (indirect; system behavior)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-002 (User Productivity Enhancement), BR-003 (Technical\nExcellence)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Aggregates: SyncState (root)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Events: DataSynchronized, SyncFailed"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"FR-SYN-001 (Local persistence)"}),"\n",(0,r.jsx)(n.li,{children:"FR-SYN-002 (Offline operation)"}),"\n",(0,r.jsx)(n.li,{children:"All bounded contexts (server APIs for sync)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sync triggers automatically on network reconnection"}),"\n",(0,r.jsx)(n.li,{children:"Sync runs periodically (every 5 minutes) when online"}),"\n",(0,r.jsx)(n.li,{children:'User can manually trigger sync via "Refresh" button'}),"\n",(0,r.jsx)(n.li,{children:"Operations are sent to server in order"}),"\n",(0,r.jsx)(n.li,{children:"Server responses are processed and local state updated"}),"\n",(0,r.jsx)(n.li,{children:"Successful operations are marked as synced (lastSyncedAt timestamp)"}),"\n",(0,r.jsx)(n.li,{children:"DataSynchronized event is published on success"}),"\n",(0,r.jsx)(n.li,{children:"Sync progress is visible in UI (progress bar, count)"}),"\n",(0,r.jsx)(n.li,{children:"Sync does not block user interactions"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"US-SYN-003-001: Auto-sync on network reconnection"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-003-002: Periodic background sync"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-003-003: Manual sync trigger"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-003-004: View sync progress"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"scenarios-2",children:"Scenarios"}),"\n",(0,r.jsx)(n.h5,{id:"scenario-1-auto-sync-on-network-reconnection-happy-path",children:"Scenario 1: Auto-sync on network reconnection (happy path)"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given the user made changes while offline",(0,r.jsx)(n.br,{}),"\n","And 5 operations are queued",(0,r.jsx)(n.br,{}),"\n","When the device reconnects to the internet",(0,r.jsx)(n.br,{}),"\n","Then the sync process automatically triggers",(0,r.jsx)(n.br,{}),"\n","And operations are sent to server in order",(0,r.jsx)(n.br,{}),"\n","And server responds with success for all operations",(0,r.jsx)(n.br,{}),"\n","And local sync state is updated: { lastSyncedAt: now, pendingOps: [] }",(0,r.jsx)(n.br,{}),"\n","And a DataSynchronized event is published",(0,r.jsx)(n.br,{}),"\n",'And a toast notification shows "Synced 5 changes"']})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-2-periodic-background-sync",children:"Scenario 2: Periodic background sync"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given the user is online",(0,r.jsx)(n.br,{}),"\n","And has made recent changes",(0,r.jsx)(n.br,{}),"\n","When 5 minutes have elapsed since last sync",(0,r.jsx)(n.br,{}),"\n","Then the sync process automatically triggers in background",(0,r.jsx)(n.br,{}),"\n","And pending operations are sent to server",(0,r.jsx)(n.br,{}),"\n","And sync completes without user awareness",(0,r.jsx)(n.br,{}),"\n","And DataSynchronized event is published"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-3-manual-sync-trigger",children:"Scenario 3: Manual sync trigger"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given the user has pending changes",(0,r.jsx)(n.br,{}),"\n",'When the user clicks "Sync Now" button',(0,r.jsx)(n.br,{}),"\n","Then sync process immediately triggers",(0,r.jsx)(n.br,{}),"\n","And a progress indicator is displayed",(0,r.jsx)(n.br,{}),"\n","And pending operations are sent to server",(0,r.jsx)(n.br,{}),"\n","And progress updates as operations complete",(0,r.jsx)(n.br,{}),"\n",'And "Sync complete" message is shown when done']})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-4-view-sync-progress",children:"Scenario 4: View sync progress"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given sync is in progress",(0,r.jsx)(n.br,{}),"\n","And 10 operations are being synced",(0,r.jsx)(n.br,{}),"\n","When the user views the UI",(0,r.jsx)(n.br,{}),"\n",'Then a progress indicator shows "Syncing... 3 of 10"',(0,r.jsx)(n.br,{}),"\n","And updates in real-time as operations complete",(0,r.jsx)(n.br,{}),"\n",'And shows "Synced" when all operations complete']})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-5-sync-pulls-server-changes",children:"Scenario 5: Sync pulls server changes"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given the user has synced local changes",(0,r.jsx)(n.br,{}),"\n","And server has changes from another device",(0,r.jsx)(n.br,{}),"\n","When sync completes",(0,r.jsx)(n.br,{}),"\n","Then server changes are fetched",(0,r.jsx)(n.br,{}),"\n","And merged into local IndexedDB",(0,r.jsx)(n.br,{}),"\n","And UI updates with new data",(0,r.jsx)(n.br,{}),"\n","And DataSynchronized event is published"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-6-partial-sync-success",children:"Scenario 6: Partial sync success"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given 5 operations are queued for sync",(0,r.jsx)(n.br,{}),"\n","When sync is triggered",(0,r.jsx)(n.br,{}),"\n","And 3 operations succeed",(0,r.jsx)(n.br,{}),"\n","And 2 operations fail (network error)",(0,r.jsx)(n.br,{}),"\n","Then successful operations are marked as synced",(0,r.jsx)(n.br,{}),"\n","And failed operations remain in queue",(0,r.jsx)(n.br,{}),"\n",'And a partial success message is shown: "Synced 3 of 5 changes"',(0,r.jsx)(n.br,{}),"\n","And failed operations are retried later"]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use Background Sync API for reliable offline-to-online sync"}),"\n",(0,r.jsx)(n.li,{children:"Implement sync engine with operation queue processor"}),"\n",(0,r.jsx)(n.li,{children:"Use HTTP requests to server APIs for each operation"}),"\n",(0,r.jsx)(n.li,{children:"Process operations sequentially (FIFO) to maintain order"}),"\n",(0,r.jsx)(n.li,{children:"Update sync metadata after each successful operation"}),"\n",(0,r.jsxs)(n.li,{children:["Implement periodic sync with ",(0,r.jsx)(n.code,{children:"setInterval"})," or Web Worker"]}),"\n",(0,r.jsx)(n.li,{children:"Use service worker for background sync when app is closed"}),"\n",(0,r.jsx)(n.li,{children:"Show sync progress using observables/event emitters"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Should sync be throttled during rapid changes (debouncing)?"}),"\n",(0,r.jsx)(n.li,{children:'Should there be a "sync pause" feature for users on metered connections?'}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"fr-syn-004-conflict-detection",children:"FR-SYN-004: Conflict detection"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Priority:"})," ",(0,r.jsx)(o.A,{priority:"Should Have"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),(0,r.jsx)(n.br,{}),"\n","The system should detect conflicts when local changes and server changes affect the same entity. Conflicts occur when an\nentity is modified both locally (while offline) and on the server (from another device) since the last sync. Detected\nconflicts are logged and prepared for resolution."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"User has made local changes to an entity"}),"\n",(0,r.jsx)(n.li,{children:"Server has changes to the same entity from another source"}),"\n",(0,r.jsx)(n.li,{children:"Sync is triggered"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Conflict is detected by comparing versions"}),"\n",(0,r.jsx)(n.li,{children:"SyncConflictDetected event is published"}),"\n",(0,r.jsx)(n.li,{children:"Conflict is logged with details"}),"\n",(0,r.jsx)(n.li,{children:"User is notified (if applicable)"}),"\n",(0,r.jsx)(n.li,{children:"Conflict is queued for resolution"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Conflicts are detected by comparing entity versions"}),"\n",(0,r.jsx)(n.li,{children:"Each entity has a version number or etag"}),"\n",(0,r.jsx)(n.li,{children:"Local version and server version are compared during sync"}),"\n",(0,r.jsx)(n.li,{children:"If versions differ, a conflict exists"}),"\n",(0,r.jsx)(n.li,{children:"Conflicts are logged with: entityId, localVersion, serverVersion, timestamp"}),"\n",(0,r.jsx)(n.li,{children:"MVP uses last-write-wins resolution (server timestamp)"}),"\n",(0,r.jsx)(n.li,{children:"Future: User-selectable resolution strategies"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"System (automatic detection)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-003 (Technical Excellence)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Aggregates: SyncState (root)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Events: SyncConflictDetected"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"FR-SYN-003 (Background synchronization)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Conflict is detected when local and server versions differ"}),"\n",(0,r.jsx)(n.li,{children:"Conflict details are logged (entity, versions, timestamp)"}),"\n",(0,r.jsx)(n.li,{children:"SyncConflictDetected event is published"}),"\n",(0,r.jsx)(n.li,{children:"User is notified via UI notification"}),"\n",(0,r.jsx)(n.li,{children:"Conflict is prepared for resolution"}),"\n",(0,r.jsx)(n.li,{children:"Non-conflicting changes continue to sync"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"US-SYN-004-001: Detect conflict during sync"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-004-002: Log conflict details"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-004-003: Notify user of conflict"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"scenarios-3",children:"Scenarios"}),"\n",(0,r.jsx)(n.h5,{id:"scenario-1-detect-conflict-during-sync-happy-path",children:"Scenario 1: Detect conflict during sync (happy path)"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:['Given a user modified task "Buy milk" locally (version 2)',(0,r.jsx)(n.br,{}),"\n","And the same task was modified on server from another device (version 3)",(0,r.jsx)(n.br,{}),"\n","When sync is triggered",(0,r.jsx)(n.br,{}),"\n","Then the system compares local version (2) with server version (3)",(0,r.jsx)(n.br,{}),"\n","And detects a conflict (versions differ)",(0,r.jsx)(n.br,{}),"\n","And logs conflict: { taskId, localVersion: 2, serverVersion: 3, timestamp }",(0,r.jsx)(n.br,{}),"\n","And publishes SyncConflictDetected event",(0,r.jsx)(n.br,{}),"\n","And queues the conflict for resolution"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-2-no-conflict-detected",children:"Scenario 2: No conflict detected"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:['Given a user modified task "Buy milk" locally (version 2)',(0,r.jsx)(n.br,{}),"\n","And the server has the same version (2)",(0,r.jsx)(n.br,{}),"\n","When sync is triggered",(0,r.jsx)(n.br,{}),"\n","Then the system compares versions",(0,r.jsx)(n.br,{}),"\n","And no conflict is detected",(0,r.jsx)(n.br,{}),"\n","And local changes are sent to server",(0,r.jsx)(n.br,{}),"\n","And sync completes successfully"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-3-log-conflict-details",children:"Scenario 3: Log conflict details"}),"\n",(0,r.jsxs)(n.admonition,{title:"gherkin",type:"note",children:[(0,r.jsxs)(n.p,{children:["Given a conflict is detected",(0,r.jsx)(n.br,{}),"\n","When the conflict is logged",(0,r.jsx)(n.br,{}),"\n","Then the log includes:"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Entity ID"}),"\n",(0,r.jsx)(n.li,{children:"Entity type"}),"\n",(0,r.jsx)(n.li,{children:"Local version"}),"\n",(0,r.jsx)(n.li,{children:"Server version"}),"\n",(0,r.jsx)(n.li,{children:"Local changes"}),"\n",(0,r.jsx)(n.li,{children:"Server changes"}),"\n",(0,r.jsx)(n.li,{children:"Timestamp"}),"\n",(0,r.jsxs)(n.li,{children:["User ID",(0,r.jsx)(n.br,{}),"\n","And the log is stored for debugging"]}),"\n"]})]}),"\n",(0,r.jsx)(n.h5,{id:"scenario-4-notify-user-of-conflict",children:"Scenario 4: Notify user of conflict"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a conflict is detected",(0,r.jsx)(n.br,{}),"\n","When SyncConflictDetected event is published",(0,r.jsx)(n.br,{}),"\n","Then a UI notification is displayed:",(0,r.jsx)(n.br,{}),"\n","\"Sync conflict detected for task 'Buy milk'\"",(0,r.jsx)(n.br,{}),"\n",'And provides options: "Keep local", "Keep server", "Merge" (if available)',(0,r.jsx)(n.br,{}),"\n","And the notification is non-blocking"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-5-multiple-conflicts",children:"Scenario 5: Multiple conflicts"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given sync detects conflicts for 3 entities",(0,r.jsx)(n.br,{}),"\n","When conflicts are processed",(0,r.jsx)(n.br,{}),"\n","Then 3 SyncConflictDetected events are published",(0,r.jsx)(n.br,{}),"\n","And all conflicts are logged",(0,r.jsx)(n.br,{}),"\n",'And a summary notification shows: "3 sync conflicts detected"',(0,r.jsx)(n.br,{}),"\n","And each conflict is queued for resolution"]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use version numbers (integer) or etags (hash) for conflict detection"}),"\n",(0,r.jsx)(n.li,{children:"Compare versions during sync before applying server changes"}),"\n",(0,r.jsx)(n.li,{children:"Store version metadata in SyncState aggregate"}),"\n",(0,r.jsx)(n.li,{children:"Implement conflict log storage (database table or file)"}),"\n",(0,r.jsx)(n.li,{children:"Use event-driven architecture to publish conflict events"}),"\n",(0,r.jsx)(n.li,{children:"Conflicts can be resolved automatically (MVP) or require user input (future)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Should all conflicts be logged persistently or only unresolved ones?"}),"\n",(0,r.jsx)(n.li,{children:"Should there be a conflict history/audit trail?"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"fr-syn-005-conflict-resolution",children:"FR-SYN-005: Conflict resolution"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Priority:"})," ",(0,r.jsx)(o.A,{priority:"Should Have"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),(0,r.jsx)(n.br,{}),"\n","The system should resolve detected conflicts using a defined strategy. MVP uses last-write-wins (server timestamp) as\nthe default resolution strategy. Future enhancements may support user-driven resolution or field-level merging."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Conflict must be detected (SyncConflictDetected event)"}),"\n",(0,r.jsx)(n.li,{children:"Local and server data must be available"}),"\n",(0,r.jsx)(n.li,{children:"Resolution strategy must be defined"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Conflict is resolved using strategy"}),"\n",(0,r.jsx)(n.li,{children:"Resolved entity is persisted locally"}),"\n",(0,r.jsx)(n.li,{children:"Sync state is updated"}),"\n",(0,r.jsx)(n.li,{children:"User is notified of resolution (if applicable)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"MVP: Last-write-wins strategy (compare timestamps)"}),"\n",(0,r.jsx)(n.li,{children:"Entity with latest timestamp is kept"}),"\n",(0,r.jsx)(n.li,{children:"Losing entity is discarded (not permanently; logged)"}),"\n",(0,r.jsx)(n.li,{children:"Resolution is automatic (no user input in MVP)"}),"\n",(0,r.jsx)(n.li,{children:"Future: Support for manual resolution, field-level merge, CRDT"}),"\n",(0,r.jsx)(n.li,{children:"Resolved conflicts are logged for audit"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"System (automatic resolution in MVP)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-003 (Technical Excellence)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Aggregates: SyncState (root)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Events: SyncConflictDetected (consumed), ConflictResolved (published)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"FR-SYN-004 (Conflict detection)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Conflict is resolved using last-write-wins strategy"}),"\n",(0,r.jsx)(n.li,{children:"Entity with latest timestamp is kept"}),"\n",(0,r.jsx)(n.li,{children:"Local data is updated with resolved version"}),"\n",(0,r.jsx)(n.li,{children:"Sync state is updated: { conflictResolved: true, resolvedAt: timestamp }"}),"\n",(0,r.jsx)(n.li,{children:"ConflictResolved event is published (optional)"}),"\n",(0,r.jsx)(n.li,{children:"User is notified of resolution outcome"}),"\n",(0,r.jsx)(n.li,{children:"Losing entity is logged (not lost)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"US-SYN-005-001: Resolve conflict with last-write-wins"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-005-002: Notify user of resolution"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-005-003: Log losing entity"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"scenarios-4",children:"Scenarios"}),"\n",(0,r.jsx)(n.h5,{id:"scenario-1-resolve-conflict-with-last-write-wins-happy-path",children:"Scenario 1: Resolve conflict with last-write-wins (happy path)"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:['Given a conflict exists for task "Buy milk"',(0,r.jsx)(n.br,{}),"\n",'And local version has timestamp "2025-11-15T10:00:00Z"',(0,r.jsx)(n.br,{}),"\n",'And server version has timestamp "2025-11-15T10:05:00Z" (later)',(0,r.jsx)(n.br,{}),"\n","When conflict resolution is triggered",(0,r.jsx)(n.br,{}),"\n","Then timestamps are compared",(0,r.jsx)(n.br,{}),"\n","And server version is kept (later timestamp)",(0,r.jsx)(n.br,{}),"\n","And local version is replaced with server version",(0,r.jsx)(n.br,{}),"\n","And sync state is updated: { conflictResolved: true, resolvedAt: now }",(0,r.jsx)(n.br,{}),"\n",'And a notification shows "Conflict resolved: server version kept"']})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-2-resolve-conflict---local-wins",children:"Scenario 2: Resolve conflict - local wins"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:['Given a conflict exists for task "Call dentist"',(0,r.jsx)(n.br,{}),"\n",'And local version has timestamp "2025-11-15T10:10:00Z"',(0,r.jsx)(n.br,{}),"\n",'And server version has timestamp "2025-11-15T10:05:00Z" (earlier)',(0,r.jsx)(n.br,{}),"\n","When conflict resolution is triggered",(0,r.jsx)(n.br,{}),"\n","Then local version is kept (later timestamp)",(0,r.jsx)(n.br,{}),"\n","And local version is sent to server (overwriting server)",(0,r.jsx)(n.br,{}),"\n","And sync state is updated",(0,r.jsx)(n.br,{}),"\n",'And a notification shows "Conflict resolved: local version kept"']})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-3-notify-user-of-resolution",children:"Scenario 3: Notify user of resolution"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a conflict is resolved",(0,r.jsx)(n.br,{}),"\n","When resolution completes",(0,r.jsx)(n.br,{}),"\n","Then a toast notification appears:",(0,r.jsx)(n.br,{}),"\n","\"Conflict resolved for task 'Buy milk': server version was more recent\"",(0,r.jsx)(n.br,{}),"\n","And the notification is informational (non-blocking)",(0,r.jsx)(n.br,{}),"\n","And dismissed after 5 seconds"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-4-log-losing-entity",children:"Scenario 4: Log losing entity"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a conflict is resolved in favor of server version",(0,r.jsx)(n.br,{}),"\n","And local version is discarded",(0,r.jsx)(n.br,{}),"\n","When resolution completes",(0,r.jsx)(n.br,{}),"\n",'Then the losing local version is logged: { entityId, version, data, discardedAt, reason: "conflict resolution" }\nAnd the log is stored for potential recovery',(0,r.jsx)(n.br,{}),"\n","And the log is retained for 30 days"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-5-multiple-conflict-resolutions",children:"Scenario 5: Multiple conflict resolutions"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given 3 conflicts exist",(0,r.jsx)(n.br,{}),"\n","When conflict resolution is triggered for all",(0,r.jsx)(n.br,{}),"\n","Then each conflict is resolved independently",(0,r.jsx)(n.br,{}),"\n","And 2 are resolved in favor of server",(0,r.jsx)(n.br,{}),"\n","And 1 is resolved in favor of local",(0,r.jsx)(n.br,{}),"\n",'And a summary notification shows: "3 conflicts resolved"',(0,r.jsx)(n.br,{}),"\n","And all resolutions are logged"]})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Implement resolution strategies as pluggable components"}),"\n",(0,r.jsx)(n.li,{children:"MVP: Last-write-wins using entity timestamps"}),"\n",(0,r.jsx)(n.li,{children:"Compare timestamps in ISO 8601 format"}),"\n",(0,r.jsx)(n.li,{children:"Future: Implement additional strategies (user-choice, field-merge, CRDT)"}),"\n",(0,r.jsx)(n.li,{children:"Log losing entities for potential recovery"}),"\n",(0,r.jsx)(n.li,{children:"Publish ConflictResolved events for audit trail"}),"\n",(0,r.jsx)(n.li,{children:"Consider implementing conflict resolution UI (future)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Should users be able to view and recover discarded conflict versions?"}),"\n",(0,r.jsx)(n.li,{children:"Should there be configurable resolution strategies per entity type?"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"fr-syn-006-sync-status-tracking",children:"FR-SYN-006: Sync status tracking"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Priority:"})," ",(0,r.jsx)(o.A,{priority:"Must Have"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),(0,r.jsx)(n.br,{}),"\n","The system must provide visibility into synchronization status, including pending operations, sync progress, last sync\ntime, and errors. Status tracking helps users understand the state of their data and trust the synchronization process."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"User must be authenticated"}),"\n",(0,r.jsx)(n.li,{children:"Sync process is active or has completed"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sync status is visible in UI"}),"\n",(0,r.jsx)(n.li,{children:"Status updates in real-time"}),"\n",(0,r.jsx)(n.li,{children:"Users can query sync status"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sync status includes: pending operations count, last sync timestamp, sync progress, error count"}),"\n",(0,r.jsx)(n.li,{children:"Status is updated in real-time during sync"}),"\n",(0,r.jsx)(n.li,{children:"Status persists in local storage"}),"\n",(0,r.jsx)(n.li,{children:"Users can query sync status via UI or API"}),"\n",(0,r.jsx)(n.li,{children:"Status includes per-entity sync state (synced, pending, error)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Authenticated User"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-002 (User Productivity Enhancement), BR-005 (User Value\nDelivery)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Aggregates: SyncState (root)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Events: All sync events"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"FR-SYN-003 (Background synchronization)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"UI displays pending operations count"}),"\n",(0,r.jsx)(n.li,{children:"UI displays last sync timestamp"}),"\n",(0,r.jsx)(n.li,{children:"UI displays sync progress during active sync"}),"\n",(0,r.jsx)(n.li,{children:"UI displays error count if sync failed"}),"\n",(0,r.jsx)(n.li,{children:"Users can view detailed sync status"}),"\n",(0,r.jsx)(n.li,{children:"Status updates in real-time"}),"\n",(0,r.jsx)(n.li,{children:"Status is accessible from main navigation"}),"\n",(0,r.jsx)(n.li,{children:"GetSyncStatus query returns detailed status"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"US-SYN-006-001: View pending operations count"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-006-002: View last sync time"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-006-003: View sync progress"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-006-004: Query detailed sync status"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"scenarios-5",children:"Scenarios"}),"\n",(0,r.jsx)(n.h5,{id:"scenario-1-view-pending-operations-count-happy-path",children:"Scenario 1: View pending operations count (happy path)"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a user has made 5 changes while offline",(0,r.jsx)(n.br,{}),"\n","When the user views the UI",(0,r.jsx)(n.br,{}),"\n",'Then a badge shows "5 pending" in the sync indicator',(0,r.jsx)(n.br,{}),"\n",'And hovering shows tooltip: "5 changes waiting to sync"']})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-2-view-last-sync-time",children:"Scenario 2: View last sync time"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given sync completed 10 minutes ago",(0,r.jsx)(n.br,{}),"\n","When the user views the sync status",(0,r.jsx)(n.br,{}),"\n",'Then the UI shows "Last synced: 10 minutes ago"',(0,r.jsx)(n.br,{}),"\n","And the timestamp updates every minute",(0,r.jsx)(n.br,{}),"\n","And clicking shows detailed timestamp"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-3-view-sync-progress",children:"Scenario 3: View sync progress"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given sync is in progress",(0,r.jsx)(n.br,{}),"\n","And 7 of 10 operations are complete",(0,r.jsx)(n.br,{}),"\n","When the user views the UI",(0,r.jsx)(n.br,{}),"\n","Then a progress bar shows 70% complete",(0,r.jsx)(n.br,{}),"\n",'And text shows "Syncing... 7 of 10"',(0,r.jsx)(n.br,{}),"\n","And the progress updates in real-time"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-4-view-sync-errors",children:"Scenario 4: View sync errors"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given sync failed for 2 operations",(0,r.jsx)(n.br,{}),"\n","When the user views the sync status",(0,r.jsx)(n.br,{}),"\n",'Then the UI shows a warning badge: "2 errors"',(0,r.jsx)(n.br,{}),"\n","And clicking shows error details",(0,r.jsx)(n.br,{}),"\n",'And provides "Retry" option']})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-5-query-detailed-sync-status",children:"Scenario 5: Query detailed sync status"}),"\n",(0,r.jsxs)(n.admonition,{title:"gherkin",type:"note",children:[(0,r.jsxs)(n.p,{children:["Given a user wants detailed sync information",(0,r.jsx)(n.br,{}),"\n","When the user navigates to Settings > Sync Status",(0,r.jsx)(n.br,{}),"\n","Then the detailed sync status page shows:"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Pending operations: 3"}),"\n",(0,r.jsx)(n.li,{children:"Last sync: 2025-11-15 14:30"}),"\n",(0,r.jsx)(n.li,{children:"Errors: 1"}),"\n",(0,r.jsx)(n.li,{children:"Synced entities: 247"}),"\n",(0,r.jsxs)(n.li,{children:["Per-entity status list",(0,r.jsx)(n.br,{}),"\n","And the page updates in real-time"]}),"\n"]})]}),"\n",(0,r.jsx)(n.h5,{id:"scenario-6-real-time-status-updates",children:"Scenario 6: Real-time status updates"}),"\n",(0,r.jsxs)(n.admonition,{title:"gherkin",type:"note",children:[(0,r.jsxs)(n.p,{children:["Given the sync status page is open",(0,r.jsx)(n.br,{}),"\n","When sync is triggered and operations complete",(0,r.jsx)(n.br,{}),"\n","Then the status updates in real-time:"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Pending count decreases"}),"\n",(0,r.jsx)(n.li,{children:"Progress bar updates"}),"\n",(0,r.jsxs)(n.li,{children:["Last sync timestamp updates",(0,r.jsx)(n.br,{}),"\n","And no page refresh is needed"]}),"\n"]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Store sync status in SyncState aggregate"}),"\n",(0,r.jsx)(n.li,{children:"Use observables/event emitters for real-time status updates"}),"\n",(0,r.jsx)(n.li,{children:"Display status in UI header/footer (badge, icon, text)"}),"\n",(0,r.jsx)(n.li,{children:"Implement GetSyncStatus query to return detailed status"}),"\n",(0,r.jsx)(n.li,{children:"Use WebSockets or polling for real-time updates"}),"\n",(0,r.jsx)(n.li,{children:"Cache status in local storage for quick access"}),"\n",(0,r.jsx)(n.li,{children:"Implement status page with detailed breakdown"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Should there be a sync activity log/history?"}),"\n",(0,r.jsx)(n.li,{children:"Should users be able to export sync logs for debugging?"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h3,{id:"fr-syn-007-retry-and-error-handling",children:"FR-SYN-007: Retry and error handling"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Priority:"})," ",(0,r.jsx)(o.A,{priority:"Must Have"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Description:"}),(0,r.jsx)(n.br,{}),"\n","The system must handle synchronization errors gracefully and retry failed operations with exponential backoff. Error\nhandling ensures resilience to transient network issues and provides users with clear feedback and recovery options."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Sync operation has failed"}),"\n",(0,r.jsx)(n.li,{children:"Error type is identified (network, server, conflict, etc.)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Error is logged with details"}),"\n",(0,r.jsx)(n.li,{children:"Failed operation is queued for retry"}),"\n",(0,r.jsx)(n.li,{children:"Retry occurs with exponential backoff"}),"\n",(0,r.jsx)(n.li,{children:"SyncFailed event is published"}),"\n",(0,r.jsx)(n.li,{children:"User is notified of error and retry status"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Failed operations are retried automatically"}),"\n",(0,r.jsx)(n.li,{children:"Retry uses exponential backoff: 1s, 2s, 4s, 8s, 16s, max 60s"}),"\n",(0,r.jsx)(n.li,{children:"Maximum retry attempts: 5 (configurable)"}),"\n",(0,r.jsx)(n.li,{children:"After max retries, operation is marked as failed"}),"\n",(0,r.jsx)(n.li,{children:"Error types: Network, Server (5xx), Client (4xx), Conflict, Timeout"}),"\n",(0,r.jsx)(n.li,{children:"Users can manually retry failed operations"}),"\n",(0,r.jsx)(n.li,{children:"Persistent failures are escalated to user"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"System (automatic retry)"}),"\n",(0,r.jsx)(n.li,{children:"Authenticated User (manual retry)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-003 (Technical Excellence), BR-005 (User Value Delivery)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Aggregates: SyncState (root)"}),"\n",(0,r.jsx)(n.li,{children:"Domain Events: SyncFailed"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"FR-SYN-003 (Background synchronization)"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Failed operations are automatically retried"}),"\n",(0,r.jsx)(n.li,{children:"Retry uses exponential backoff (1s, 2s, 4s, 8s, 16s, 60s max)"}),"\n",(0,r.jsx)(n.li,{children:"Maximum 5 retry attempts"}),"\n",(0,r.jsx)(n.li,{children:"Error is logged with type, details, and timestamp"}),"\n",(0,r.jsx)(n.li,{children:"SyncFailed event is published"}),"\n",(0,r.jsx)(n.li,{children:"User is notified of error and retry status"}),"\n",(0,r.jsx)(n.li,{children:"User can manually trigger retry"}),"\n",(0,r.jsx)(n.li,{children:"Persistent failures show actionable error message"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"US-SYN-007-001: Auto-retry failed operation"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-007-002: Exponential backoff"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-007-003: Manual retry"}),"\n",(0,r.jsx)(n.li,{children:"US-SYN-007-004: Persistent failure notification"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h4,{id:"scenarios-6",children:"Scenarios"}),"\n",(0,r.jsx)(n.h5,{id:"scenario-1-auto-retry-failed-operation-happy-path",children:"Scenario 1: Auto-retry failed operation (happy path)"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a sync operation fails due to network timeout",(0,r.jsx)(n.br,{}),"\n","When the error is detected",(0,r.jsx)(n.br,{}),"\n","Then the operation is logged as failed",(0,r.jsx)(n.br,{}),"\n","And queued for retry with backoff: 1s",(0,r.jsx)(n.br,{}),"\n","And after 1 second, retry is attempted",(0,r.jsx)(n.br,{}),"\n","And if it fails again, backoff doubles to 2s",(0,r.jsx)(n.br,{}),"\n","And retry continues up to 5 attempts",(0,r.jsx)(n.br,{}),"\n","And if it succeeds, operation is marked as synced"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-2-exponential-backoff",children:"Scenario 2: Exponential backoff"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a sync operation fails",(0,r.jsx)(n.br,{}),"\n","When retries are scheduled",(0,r.jsx)(n.br,{}),"\n","Then backoff intervals are: 1s, 2s, 4s, 8s, 16s, 60s (capped)",(0,r.jsx)(n.br,{}),"\n","And retry attempts stop after 5 failures",(0,r.jsx)(n.br,{}),"\n","And backoff timing is logged for debugging"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-3-manual-retry",children:"Scenario 3: Manual retry"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a sync operation has failed 5 times",(0,r.jsx)(n.br,{}),"\n","And is marked as permanently failed",(0,r.jsx)(n.br,{}),"\n","When the user views the error notification",(0,r.jsx)(n.br,{}),"\n",'And clicks "Retry Now"',(0,r.jsx)(n.br,{}),"\n","Then the operation is immediately retried",(0,r.jsx)(n.br,{}),"\n","And retry counter is reset",(0,r.jsx)(n.br,{}),"\n","And success/failure is reported to user"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-4-persistent-failure-notification",children:"Scenario 4: Persistent failure notification"}),"\n",(0,r.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,r.jsxs)(n.p,{children:["Given a sync operation has failed 5 times",(0,r.jsx)(n.br,{}),"\n","And maximum retries are exhausted",(0,r.jsx)(n.br,{}),"\n","When the final retry fails",(0,r.jsx)(n.br,{}),"\n","Then a SyncFailed event is published",(0,r.jsx)(n.br,{}),"\n",'And a notification appears: "Unable to sync. Please check your connection and try again."',(0,r.jsx)(n.br,{}),"\n",'And provides "Retry" and "View Details" options',(0,r.jsx)(n.br,{}),"\n","And the operation remains queued"]})}),"\n",(0,r.jsx)(n.h5,{id:"scenario-5-different-error-types",children:"Scenario 5: Different error types"}),"\n",(0,r.jsxs)(n.admonition,{title:"gherkin",type:"note",children:[(0,r.jsxs)(n.p,{children:["Given sync operations fail with different errors",(0,r.jsx)(n.br,{}),"\n","When errors are handled:"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Network error \u2192 retry with backoff"}),"\n",(0,r.jsx)(n.li,{children:"Server 500 error \u2192 retry with backoff"}),"\n",(0,r.jsx)(n.li,{children:"Server 400 error \u2192 log and notify user (no retry)"}),"\n",(0,r.jsx)(n.li,{children:"Conflict \u2192 trigger conflict resolution"}),"\n",(0,r.jsxs)(n.li,{children:["Timeout \u2192 retry with longer timeout",(0,r.jsx)(n.br,{}),"\n","Then each error type has appropriate handling"]}),"\n"]})]}),"\n",(0,r.jsx)(n.h5,{id:"scenario-6-error-logging",children:"Scenario 6: Error logging"}),"\n",(0,r.jsxs)(n.admonition,{title:"gherkin",type:"note",children:[(0,r.jsxs)(n.p,{children:["Given a sync operation fails",(0,r.jsx)(n.br,{}),"\n","When the error is logged",(0,r.jsx)(n.br,{}),"\n","Then the log includes:"]}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Error type"}),"\n",(0,r.jsx)(n.li,{children:"Error message"}),"\n",(0,r.jsx)(n.li,{children:"Stack trace (if applicable)"}),"\n",(0,r.jsx)(n.li,{children:"Entity ID"}),"\n",(0,r.jsx)(n.li,{children:"Retry attempt number"}),"\n",(0,r.jsx)(n.li,{children:"Timestamp"}),"\n",(0,r.jsxs)(n.li,{children:["User ID",(0,r.jsx)(n.br,{}),"\n","And logs are available for debugging"]}),"\n"]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Implement retry queue with exponential backoff scheduler"}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"setTimeout"})," or similar for scheduling retries"]}),"\n",(0,r.jsx)(n.li,{children:"Store retry count and next retry time in sync state"}),"\n",(0,r.jsx)(n.li,{children:"Classify errors by type (network, server, client, conflict)"}),"\n",(0,r.jsx)(n.li,{children:"Log all errors with structured logging (JSON)"}),"\n",(0,r.jsx)(n.li,{children:"Use error monitoring service (e.g., Sentry) for production"}),"\n",(0,r.jsx)(n.li,{children:"Implement circuit breaker for repeated server failures (future)"}),"\n",(0,r.jsx)(n.li,{children:"Provide clear, actionable error messages to users"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Should retry intervals be configurable per error type?"}),"\n",(0,r.jsx)(n.li,{children:'Should there be a "sync health" dashboard for administrators?'}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"cross-feature-considerations",children:"Cross-feature considerations"}),"\n",(0,r.jsx)(n.h3,{id:"interactions-between-features",children:"Interactions between features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Local Persistence \u2194 Offline Operation:"})," Local persistence enables offline operation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Offline Operation \u2194 Background Synchronization:"})," Offline changes are queued and synced when online"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Background Synchronization \u2194 Conflict Detection:"})," Sync triggers conflict detection by comparing versions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Conflict Detection \u2194 Conflict Resolution:"})," Detected conflicts are resolved using defined strategies"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Sync Status Tracking \u2194 All Features:"})," Status tracking monitors all sync activities"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Retry and Error Handling \u2194 Background Synchronization:"})," Failed sync operations are retried with backoff"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"shared-business-rules",children:"Shared business rules"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Offline-First:"})," All data operations work offline; cloud is secondary"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Eventual Consistency:"})," System guarantees eventual consistency between local and server"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Operation Ordering:"})," Operations are synced in order (FIFO) to maintain causality"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Conflict Resolution:"})," Conflicts are resolved deterministically (last-write-wins in MVP)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Resilience:"})," Transient errors are retried; persistent errors are escalated to user"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Transparency:"})," Sync status and errors are visible to users"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"data-consistency-requirements",children:"Data consistency requirements"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Local Consistency:"})," Strong consistency within local IndexedDB transactions"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Eventual Consistency:"})," Eventual consistency between local and server"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Conflict Resolution:"})," Deterministic resolution ensures consistency across devices"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Operation Atomicity:"})," Each sync operation is atomic (all or nothing)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Idempotency:"})," Sync operations are idempotent (can be safely retried)"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"business-constraints-impact",children:"Business constraints impact"}),"\n",(0,r.jsx)(n.h3,{id:"bc-001-budget",children:"BC-001: Budget"}),"\n",(0,r.jsx)(n.p,{children:"Synchronization must operate within zero-cost infrastructure constraints:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Local Storage:"})," Use browser IndexedDB (free, built-in)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cloud Storage:"})," Use free-tier database (PostgreSQL via Railway, Supabase)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Sync Protocol:"})," Use HTTP REST APIs (no paid sync service)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error Monitoring:"})," Use free-tier logging (no paid Sentry initially)"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"bc-002-timeline",children:"BC-002: Timeline"}),"\n",(0,r.jsx)(n.p,{children:"Synchronization is important but can be simplified for MVP (3-6 months):"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Must Have features"})," (FR-SYN-001, 002, 003, 006, 007) required for MVP"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Should Have features"})," (FR-SYN-004, 005) can use simple strategies (last-write-wins)"]}),"\n",(0,r.jsx)(n.li,{children:"Prioritize basic offline operation and auto-sync"}),"\n",(0,r.jsx)(n.li,{children:"Defer advanced conflict resolution (user-driven, field-merge) to post-MVP"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"bc-003-resources",children:"BC-003: Resources"}),"\n",(0,r.jsx)(n.p,{children:"Single-developer constraints affect Synchronization:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Simplify Conflict Resolution:"})," Use last-write-wins only in MVP (no CRDT)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Leverage Libraries:"})," Use Dexie.js for IndexedDB, RxJS for observables"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Automate Testing:"})," Mock network conditions (offline/online) in tests"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Incremental Development:"})," Build local persistence first, then offline, then sync"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"bc-004-technology-stack",children:"BC-004: Technology stack"}),"\n",(0,r.jsx)(n.p,{children:"Synchronization aligns with chosen stack:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Frontend:"})," Angular with service workers for offline support, RxJS for reactive sync status"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Local Storage:"})," IndexedDB via Dexie.js wrapper"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Backend:"})," Spring Boot REST APIs for sync endpoints"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Database:"})," PostgreSQL for server-side data storage"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Encryption:"})," Web Crypto API for local encryption"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Service Worker:"})," Workbox for offline app shell caching"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"success-metrics-alignment",children:"Success metrics alignment"}),"\n",(0,r.jsx)(n.p,{children:"Synchronization contributes to the following success metrics from BR-001 through BR-008:"}),"\n",(0,r.jsx)(n.h3,{id:"br-003-technical-metrics",children:"BR-003: Technical metrics"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Metric"}),(0,r.jsx)(n.th,{children:"Target"}),(0,r.jsx)(n.th,{children:"Synchronization contribution"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Offline Support"})}),(0,r.jsx)(n.td,{children:"Full function"}),(0,r.jsx)(n.td,{children:"Complete offline CRUD operations with automatic sync"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Sync Success Rate"})}),(0,r.jsx)(n.td,{children:"> 99%"}),(0,r.jsx)(n.td,{children:"Reliable sync with retry and error handling"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Test Coverage"})}),(0,r.jsx)(n.td,{children:"> 80%"}),(0,r.jsx)(n.td,{children:"Comprehensive offline/online scenario testing"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"br-001-portfolio-quality-metrics",children:"BR-001: Portfolio quality metrics"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Metric"}),(0,r.jsx)(n.th,{children:"Target"}),(0,r.jsx)(n.th,{children:"Synchronization contribution"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Architecture Documentation"})}),(0,r.jsx)(n.td,{children:"All views complete"}),(0,r.jsx)(n.td,{children:"Offline-first architecture, sync engine design, conflict resolution"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Code Quality Score"})}),(0,r.jsx)(n.td,{children:"No critical issues"}),(0,r.jsx)(n.td,{children:"Clean sync logic, proper error handling, testable offline code"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"br-002-br-005-user-experience-metrics",children:"BR-002, BR-005: User experience metrics"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Metric"}),(0,r.jsx)(n.th,{children:"Target"}),(0,r.jsx)(n.th,{children:"Synchronization contribution"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Offline Capability"})}),(0,r.jsx)(n.td,{children:"Must Have"}),(0,r.jsx)(n.td,{children:"Full app functionality offline, seamless online/offline"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Sync Transparency"})}),(0,r.jsx)(n.td,{children:"High"}),(0,r.jsx)(n.td,{children:"Clear status indicators, error messages, progress tracking"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.strong,{children:"Data Loss Prevention"})}),(0,r.jsx)(n.td,{children:"Zero data loss"}),(0,r.jsx)(n.td,{children:"Reliable sync with conflict detection and resolution"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"traceability-matrix",children:"Traceability matrix"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Feature"}),(0,r.jsx)(n.th,{children:"Business Req"}),(0,r.jsx)(n.th,{children:"Domain Events"}),(0,r.jsx)(n.th,{children:"User Stories"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-001"}),(0,r.jsx)(n.td,{children:"BR-001, BR-002, BR-003, BR-005"}),(0,r.jsx)(n.td,{children:"All domain events (for persistence)"}),(0,r.jsx)(n.td,{children:"US-SYN-001-001/002/003/004"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-002"}),(0,r.jsx)(n.td,{children:"BR-001, BR-002, BR-005"}),(0,r.jsx)(n.td,{children:"All domain events (queued offline)"}),(0,r.jsx)(n.td,{children:"US-SYN-002-001/002/003/004"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-003"}),(0,r.jsx)(n.td,{children:"BR-001, BR-002, BR-003"}),(0,r.jsx)(n.td,{children:"DataSynchronized, SyncFailed"}),(0,r.jsx)(n.td,{children:"US-SYN-003-001/002/003/004"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-004"}),(0,r.jsx)(n.td,{children:"BR-001, BR-003"}),(0,r.jsx)(n.td,{children:"SyncConflictDetected"}),(0,r.jsx)(n.td,{children:"US-SYN-004-001/002/003"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-005"}),(0,r.jsx)(n.td,{children:"BR-001, BR-003"}),(0,r.jsx)(n.td,{children:"SyncConflictDetected (consumed), ConflictResolved"}),(0,r.jsx)(n.td,{children:"US-SYN-005-001/002/003"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-006"}),(0,r.jsx)(n.td,{children:"BR-001, BR-002, BR-005"}),(0,r.jsx)(n.td,{children:"All sync events"}),(0,r.jsx)(n.td,{children:"US-SYN-006-001/002/003/004"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"FR-SYN-007"}),(0,r.jsx)(n.td,{children:"BR-001, BR-003, BR-005"}),(0,r.jsx)(n.td,{children:"SyncFailed"}),(0,r.jsx)(n.td,{children:"US-SYN-007-001/002/003/004"})]})]})]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(j,{...e})}):j(e)}},4761:(e,n,s)=>{s.d(n,{A:()=>l});const i={reqMetadata:"reqMetadata_OnDx"};var r=s(1487),t=s(7259);function l({status:e,lastUpdated:n}){return(0,t.jsxs)("div",{className:i.reqMetadata,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Status: "}),(0,t.jsx)(r.A,{status:e})]}),n&&(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Last updated"}),": ",(s=n,new Intl.DateTimeFormat("en-US",{dateStyle:"long"}).format(s))]})]});var s}},5739:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>o});var i=s(6363);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}},6453:(e,n,s)=>{s.d(n,{A:()=>l});const i={priorityLabel:"priorityLabel_hNWY",priorityLabelMustHave:"priorityLabelMustHave_fw2O",priorityLabelShouldHave:"priorityLabelShouldHave_iftn",priorityLabelCouldHave:"priorityLabelCouldHave_Pzg7",priorityLabelWontHave:"priorityLabelWontHave_d7BD"};var r=s(7259);function t(e){const n=e.replaceAll(" ","").replaceAll("'","");return i.priorityLabel+" "+i[`priorityLabel${n}`]}function l(e){return(0,r.jsx)("span",{className:t(e.priority),children:e.priority||"-"})}}}]);