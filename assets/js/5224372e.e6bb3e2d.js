"use strict";(globalThis.webpackChunkbrowser_dashboard_pwa_docs=globalThis.webpackChunkbrowser_dashboard_pwa_docs||[]).push([[7837],{1487:(e,n,s)=>{s.d(n,{A:()=>t});const r={reqStatus:"reqStatus_It10",reqStatusDraft:"reqStatusDraft_r86d",reqStatusReady:"reqStatusReady_vlST",reqStatusDone:"reqStatusDone_Fh10",reqStatusReleased:"reqStatusReleased_cVtA"};var i=s(7259);function t(e){return(0,i.jsx)("span",{className:(n=e.status,r.reqStatus+" "+r[`reqStatus${n}`]),children:e.status||"-"});var n}},4761:(e,n,s)=>{s.d(n,{A:()=>l});const r={reqMetadata:"reqMetadata_OnDx"};var i=s(1487),t=s(7259);function l({status:e,lastUpdated:n}){return(0,t.jsxs)("div",{className:r.reqMetadata,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("strong",{children:"Status: "}),(0,t.jsx)(i.A,{status:e})]}),n&&(0,t.jsxs)("span",{children:[(0,t.jsx)("strong",{children:"Last updated"}),": ",(s=n,new Intl.DateTimeFormat("en-US",{dateStyle:"long"}).format(s))]})]});var s}},5739:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>a});var r=s(6363);const i={},t=r.createContext(i);function l(e){const n=r.useContext(t);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),r.createElement(t.Provider,{value:n},e.children)}},5763:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>h,contentTitle:()=>o,default:()=>u,frontMatter:()=>d,metadata:()=>r,toc:()=>x});const r=JSON.parse('{"id":"requirements/functional/preferences","title":"Preferences","description":"Overview","source":"@site/docs/requirements/functional/preferences.mdx","sourceDirName":"requirements/functional","slug":"/requirements/functional/preferences","permalink":"/browser-dashboard-pwa/docs/requirements/functional/preferences","draft":false,"unlisted":false,"editUrl":"https://github.com/migmolrod/browser-dashboard-pwa/tree/master/docs/docs/requirements/functional/preferences.mdx","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"title":"Preferences","status":"Draft","lastUpdated":"2025-11-15T00:00:00.000Z"},"sidebar":"requirements","previous":{"title":"User identity","permalink":"/browser-dashboard-pwa/docs/requirements/functional/user-identity"},"next":{"title":"Synchronization","permalink":"/browser-dashboard-pwa/docs/requirements/functional/synchronization"}}');var i=s(7259),t=s(5739),l=s(4761),a=s(6453),c=s(1487);const d={sidebar_position:8,title:"Preferences",status:"Draft",lastUpdated:new Date("2025-11-15T00:00:00.000Z")},o="Preferences",h={},x=[{value:"Overview",id:"overview",level:2},{value:"Features",id:"features",level:2},{value:"Summary",id:"summary",level:3},{value:"FR-PRE-001: Theme management",id:"fr-pre-001-theme-management",level:3},{value:"Scenarios",id:"scenarios",level:4},{value:"Scenario 1: Select light theme (happy path)",id:"scenario-1-select-light-theme-happy-path",level:5},{value:"Scenario 2: Select dark theme",id:"scenario-2-select-dark-theme",level:5},{value:"Scenario 3: Select system theme",id:"scenario-3-select-system-theme",level:5},{value:"Scenario 4: System theme adapts to OS changes",id:"scenario-4-system-theme-adapts-to-os-changes",level:5},{value:"Scenario 5: Theme persists across sessions",id:"scenario-5-theme-persists-across-sessions",level:5},{value:"Scenario 6: Default theme for new users",id:"scenario-6-default-theme-for-new-users",level:5},{value:"FR-PRE-002: Locale management",id:"fr-pre-002-locale-management",level:3},{value:"Scenarios",id:"scenarios-1",level:4},{value:"Scenario 1: Select locale (happy path)",id:"scenario-1-select-locale-happy-path",level:5},{value:"Scenario 2: View date in locale format",id:"scenario-2-view-date-in-locale-format",level:5},{value:"Scenario 3: View numbers in locale format",id:"scenario-3-view-numbers-in-locale-format",level:5},{value:"Scenario 4: Reject invalid locale",id:"scenario-4-reject-invalid-locale",level:5},{value:"Scenario 5: Locale persists across sessions",id:"scenario-5-locale-persists-across-sessions",level:5},{value:"Scenario 6: Default locale for new users",id:"scenario-6-default-locale-for-new-users",level:5},{value:"FR-PRE-003: Timezone management",id:"fr-pre-003-timezone-management",level:3},{value:"Scenarios",id:"scenarios-2",level:4},{value:"Scenario 1: Select timezone (happy path)",id:"scenario-1-select-timezone-happy-path",level:5},{value:"Scenario 2: View timestamps in timezone",id:"scenario-2-view-timestamps-in-timezone",level:5},{value:"Scenario 3: Autodetect timezone from browser",id:"scenario-3-autodetect-timezone-from-browser",level:5},{value:"Scenario 4: Reject invalid timezone",id:"scenario-4-reject-invalid-timezone",level:5},{value:"Scenario 5: Timezone persists across sessions",id:"scenario-5-timezone-persists-across-sessions",level:5},{value:"Scenario 6: Search timezone by city name",id:"scenario-6-search-timezone-by-city-name",level:5},{value:"FR-PRE-004: Default preferences",id:"fr-pre-004-default-preferences",level:3},{value:"Scenarios",id:"scenarios-3",level:4},{value:"Scenario 1: Create default preferences on registration (happy path)",id:"scenario-1-create-default-preferences-on-registration-happy-path",level:5},{value:"Scenario 2: Verify default values",id:"scenario-2-verify-default-values",level:5},{value:"Scenario 3: User can change defaults",id:"scenario-3-user-can-change-defaults",level:5},{value:"Scenario 4: Idempotent preference creation",id:"scenario-4-idempotent-preference-creation",level:5},{value:"Scenario 5: Browser timezone detection",id:"scenario-5-browser-timezone-detection",level:5},{value:"FR-PRE-005: Preference persistence",id:"fr-pre-005-preference-persistence",level:3},{value:"Scenarios",id:"scenarios-4",level:4},{value:"Scenario 1: Persist preference changes (happy path)",id:"scenario-1-persist-preference-changes-happy-path",level:5},{value:"Scenario 2: Retrieve preferences on login",id:"scenario-2-retrieve-preferences-on-login",level:5},{value:"Scenario 3: Handle concurrent updates",id:"scenario-3-handle-concurrent-updates",level:5},{value:"Scenario 4: Persist across restarts",id:"scenario-4-persist-across-restarts",level:5},{value:"Scenario 5: Persistence failure - retry",id:"scenario-5-persistence-failure---retry",level:5},{value:"FR-PRE-006: Preference validation",id:"fr-pre-006-preference-validation",level:3},{value:"Scenarios",id:"scenarios-5",level:4},{value:"Scenario 1: Validate theme value (happy path)",id:"scenario-1-validate-theme-value-happy-path",level:5},{value:"Scenario 2: Reject invalid theme value",id:"scenario-2-reject-invalid-theme-value",level:5},{value:"Scenario 3: Validate locale value",id:"scenario-3-validate-locale-value",level:5},{value:"Scenario 4: Reject invalid locale value",id:"scenario-4-reject-invalid-locale-value",level:5},{value:"Scenario 5: Validate timezone value",id:"scenario-5-validate-timezone-value",level:5},{value:"Scenario 6: Reject invalid timezone value",id:"scenario-6-reject-invalid-timezone-value",level:5},{value:"Scenario 7: Reject multiple invalid values",id:"scenario-7-reject-multiple-invalid-values",level:5},{value:"Cross-feature considerations",id:"cross-feature-considerations",level:2},{value:"Interactions between features",id:"interactions-between-features",level:3},{value:"Shared business rules",id:"shared-business-rules",level:3},{value:"Data consistency requirements",id:"data-consistency-requirements",level:3},{value:"Business constraints impact",id:"business-constraints-impact",level:2},{value:"BC-001: Budget",id:"bc-001-budget",level:3},{value:"BC-002: Timeline",id:"bc-002-timeline",level:3},{value:"BC-003: Resources",id:"bc-003-resources",level:3},{value:"BC-004: Technology stack",id:"bc-004-technology-stack",level:3},{value:"Success metrics alignment",id:"success-metrics-alignment",level:2},{value:"BR-003: Technical metrics",id:"br-003-technical-metrics",level:3},{value:"BR-001: Portfolio quality metrics",id:"br-001-portfolio-quality-metrics",level:3},{value:"BR-002, BR-005: User experience metrics",id:"br-002-br-005-user-experience-metrics",level:3},{value:"Traceability matrix",id:"traceability-matrix",level:2}];function j(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.A,{status:d.status,lastUpdated:d.lastUpdated}),"\n",(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"preferences",children:"Preferences"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"The Preferences bounded context manages cross-cutting user preferences such as theme, locale, timezone, and default\nsettings. It serves as the single source of truth for user-specific configuration that affects the entire application.\nThe context provides sensible defaults and notifies other contexts when preferences change."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Bounded context code:"})," PRE",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Related DMD section:"})," ",(0,i.jsx)(n.a,{href:"../../domain/bounded-contexts/preferences",children:"Preferences (Generic)"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,i.jsx)(n.h3,{id:"summary",children:"Summary"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature Code"}),(0,i.jsx)(n.th,{children:"Feature Name"}),(0,i.jsx)(n.th,{children:"Priority"}),(0,i.jsx)(n.th,{children:"Status"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-001"}),(0,i.jsx)(n.td,{children:"Theme management"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(a.A,{priority:"Must Have"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(c.A,{status:"Draft"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-002"}),(0,i.jsx)(n.td,{children:"Locale management"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(a.A,{priority:"Should Have"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(c.A,{status:"Draft"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-003"}),(0,i.jsx)(n.td,{children:"Timezone management"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(a.A,{priority:"Should Have"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(c.A,{status:"Draft"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-004"}),(0,i.jsx)(n.td,{children:"Default preferences"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(a.A,{priority:"Must Have"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(c.A,{status:"Draft"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-005"}),(0,i.jsx)(n.td,{children:"Preference persistence"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(a.A,{priority:"Must Have"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(c.A,{status:"Draft"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-006"}),(0,i.jsx)(n.td,{children:"Preference validation"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(a.A,{priority:"Must Have"})}),(0,i.jsx)(n.td,{children:(0,i.jsx)(c.A,{status:"Draft"})})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"fr-pre-001-theme-management",children:"FR-PRE-001: Theme management"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Priority:"})," ",(0,i.jsx)(a.A,{priority:"Must Have"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),(0,i.jsx)(n.br,{}),"\n","Users must be able to select and switch between visual themes (light, dark, and system default). Theme preference\naffects the visual appearance of the entire application and persists across sessions. System default automatically\nadapts to the user's operating system theme preference."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User must be authenticated"}),"\n",(0,i.jsx)(n.li,{children:"UserPreferences aggregate must exist"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Theme preference is updated"}),"\n",(0,i.jsx)(n.li,{children:"ThemeChanged event is published"}),"\n",(0,i.jsx)(n.li,{children:"Application appearance updates in real-time"}),"\n",(0,i.jsx)(n.li,{children:"Theme preference persists across sessions"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Supported themes: Light, Dark, System (follows OS preference)"}),"\n",(0,i.jsx)(n.li,{children:'Default theme is "System" for new users'}),"\n",(0,i.jsx)(n.li,{children:"Theme changes apply immediately without page reload"}),"\n",(0,i.jsx)(n.li,{children:"Theme preference is global (not per-device in MVP)"}),"\n",(0,i.jsx)(n.li,{children:"System theme dynamically updates when OS theme changes"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Authenticated User"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-002 (User Productivity Enhancement), BR-005 (User Value\nDelivery)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Aggregates: UserPreferences (root)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Events: ThemeChanged, UserRegistered (consumed)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User Identity context (UserId association)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User can select theme from: Light, Dark, System"}),"\n",(0,i.jsx)(n.li,{children:"Theme changes apply immediately to entire application"}),"\n",(0,i.jsx)(n.li,{children:"ThemeChanged event is published with new theme value"}),"\n",(0,i.jsx)(n.li,{children:"Theme preference persists across sessions"}),"\n",(0,i.jsx)(n.li,{children:"System theme follows OS preference (detects changes)"}),"\n",(0,i.jsx)(n.li,{children:"Theme selection is accessible from settings menu"}),"\n",(0,i.jsx)(n.li,{children:"Visual feedback confirms theme change"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"US-PRE-001-001: Select light theme"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-001-002: Select dark theme"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-001-003: Select system theme"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-001-004: System theme adapts to OS changes"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"scenarios",children:"Scenarios"}),"\n",(0,i.jsx)(n.h5,{id:"scenario-1-select-light-theme-happy-path",children:"Scenario 1: Select light theme (happy path)"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is authenticated",(0,i.jsx)(n.br,{}),"\n","And viewing the preferences settings",(0,i.jsx)(n.br,{}),"\n",'When the user selects "Light" theme',(0,i.jsx)(n.br,{}),"\n","And saves preferences",(0,i.jsx)(n.br,{}),"\n",'Then the theme preference is updated to "Light"',(0,i.jsx)(n.br,{}),"\n","And a ThemeChanged event is published",(0,i.jsx)(n.br,{}),"\n","And the application switches to light theme immediately",(0,i.jsx)(n.br,{}),"\n","And all UI components update with light theme colors",(0,i.jsx)(n.br,{}),"\n","And the preference is persisted"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-2-select-dark-theme",children:"Scenario 2: Select dark theme"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user has light theme active",(0,i.jsx)(n.br,{}),"\n",'When the user selects "Dark" theme',(0,i.jsx)(n.br,{}),"\n","And saves preferences",(0,i.jsx)(n.br,{}),"\n",'Then the theme preference is updated to "Dark"',(0,i.jsx)(n.br,{}),"\n","And a ThemeChanged event is published",(0,i.jsx)(n.br,{}),"\n","And the application switches to dark theme immediately",(0,i.jsx)(n.br,{}),"\n","And all UI components update with dark theme colors"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-3-select-system-theme",children:"Scenario 3: Select system theme"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user has dark theme active",(0,i.jsx)(n.br,{}),"\n",'When the user selects "System" theme',(0,i.jsx)(n.br,{}),"\n","And saves preferences",(0,i.jsx)(n.br,{}),"\n",'Then the theme preference is updated to "System"',(0,i.jsx)(n.br,{}),"\n","And a ThemeChanged event is published",(0,i.jsx)(n.br,{}),"\n","And the application detects OS theme preference",(0,i.jsx)(n.br,{}),"\n","And applies matching theme (light or dark)",(0,i.jsx)(n.br,{}),"\n","And updates dynamically if OS theme changes"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-4-system-theme-adapts-to-os-changes",children:"Scenario 4: System theme adapts to OS changes"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:['Given a user has "System" theme selected',(0,i.jsx)(n.br,{}),"\n","And OS is currently in light mode",(0,i.jsx)(n.br,{}),"\n","When the OS switches to dark mode",(0,i.jsx)(n.br,{}),"\n","Then the application detects the OS theme change",(0,i.jsx)(n.br,{}),"\n","And automatically switches to dark theme",(0,i.jsx)(n.br,{}),"\n","And no ThemeChanged event is published (no user action)",(0,i.jsx)(n.br,{}),"\n",'And the preference remains "System"']})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-5-theme-persists-across-sessions",children:"Scenario 5: Theme persists across sessions"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:['Given a user has selected "Dark" theme',(0,i.jsx)(n.br,{}),"\n","When the user logs out and logs back in",(0,i.jsx)(n.br,{}),"\n",'Then the theme is restored to "Dark"',(0,i.jsx)(n.br,{}),"\n","And the application loads with dark theme",(0,i.jsx)(n.br,{}),"\n","And theme preference is retrieved from storage"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-6-default-theme-for-new-users",children:"Scenario 6: Default theme for new users"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a new user has just registered",(0,i.jsx)(n.br,{}),"\n","When the UserRegistered event is processed",(0,i.jsx)(n.br,{}),"\n","Then default preferences are created",(0,i.jsx)(n.br,{}),"\n",'And theme is set to "System"',(0,i.jsx)(n.br,{}),"\n","And the application uses OS theme preference initially"]})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use CSS custom properties (variables) for theme colors"}),"\n",(0,i.jsxs)(n.li,{children:["Implement theme detection via ",(0,i.jsx)(n.code,{children:"window.matchMedia('(prefers-color-scheme: dark)')"})]}),"\n",(0,i.jsx)(n.li,{children:"Store theme preference as enumeration (LIGHT, DARK, SYSTEM)"}),"\n",(0,i.jsxs)(n.li,{children:["Listen for OS theme changes with ",(0,i.jsx)(n.code,{children:"matchMedia.addEventListener('change', ...)"})]}),"\n",(0,i.jsxs)(n.li,{children:["Apply theme immediately via CSS class on root element (e.g., ",(0,i.jsx)(n.code,{children:'<html class="dark">'}),")"]}),"\n",(0,i.jsx)(n.li,{children:"Consider implementing theme transition animations for smooth switching"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Should there be additional theme options (e.g., high contrast, custom colors)?"}),"\n",(0,i.jsx)(n.li,{children:"Should theme be device-specific in the future?"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"fr-pre-002-locale-management",children:"FR-PRE-002: Locale management"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Priority:"})," ",(0,i.jsx)(a.A,{priority:"Should Have"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),(0,i.jsx)(n.br,{}),"\n","Users should be able to select their preferred locale (language and region) for the application interface. Locale\naffects language, date formats, number formats, and other region-specific settings. The system provides a catalog of\nsupported locales."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User must be authenticated"}),"\n",(0,i.jsx)(n.li,{children:"UserPreferences aggregate must exist"}),"\n",(0,i.jsx)(n.li,{children:"Locale must be supported by the system"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Locale preference is updated"}),"\n",(0,i.jsx)(n.li,{children:"LocaleChanged event is published"}),"\n",(0,i.jsx)(n.li,{children:"Application language updates in real-time"}),"\n",(0,i.jsx)(n.li,{children:"Date and number formats adjust to locale"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:'Default locale is "en-US" (English - United States)'}),"\n",(0,i.jsx)(n.li,{children:"Supported locales are defined in configuration (e.g., en-US, es-ES, fr-FR, de-DE)"}),"\n",(0,i.jsx)(n.li,{children:"Invalid locales are rejected with validation error"}),"\n",(0,i.jsx)(n.li,{children:"Locale changes apply immediately"}),"\n",(0,i.jsx)(n.li,{children:"Locale affects: UI language, date formats, number formats, currency symbols"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Authenticated User"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-002 (User Productivity Enhancement), BR-005 (User Value\nDelivery)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Aggregates: UserPreferences (root)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Events: LocaleChanged, UserRegistered (consumed)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User Identity context (UserId association)"}),"\n",(0,i.jsx)(n.li,{children:"Internationalization (i18n) infrastructure"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User can select locale from supported list"}),"\n",(0,i.jsx)(n.li,{children:"Locale changes apply immediately to entire application"}),"\n",(0,i.jsx)(n.li,{children:"LocaleChanged event is published with new locale"}),"\n",(0,i.jsx)(n.li,{children:"UI language switches to selected locale"}),"\n",(0,i.jsx)(n.li,{children:"Date formats adapt to locale (e.g., MM/DD/YYYY vs DD/MM/YYYY)"}),"\n",(0,i.jsx)(n.li,{children:"Number formats adapt to locale (e.g., 1,000.50 vs 1.000,50)"}),"\n",(0,i.jsx)(n.li,{children:"Locale preference persists across sessions"}),"\n",(0,i.jsx)(n.li,{children:"Invalid locale selection shows error message"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"US-PRE-002-001: Select locale"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-002-002: View date in locale format"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-002-003: View numbers in locale format"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-002-004: Reject invalid locale"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"scenarios-1",children:"Scenarios"}),"\n",(0,i.jsx)(n.h5,{id:"scenario-1-select-locale-happy-path",children:"Scenario 1: Select locale (happy path)"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is viewing preferences settings",(0,i.jsx)(n.br,{}),"\n",'And current locale is "en-US"',(0,i.jsx)(n.br,{}),"\n",'When the user selects locale "es-ES" (Spanish - Spain)',(0,i.jsx)(n.br,{}),"\n","And saves preferences",(0,i.jsx)(n.br,{}),"\n",'Then the locale preference is updated to "es-ES"',(0,i.jsx)(n.br,{}),"\n","And a LocaleChanged event is published",(0,i.jsx)(n.br,{}),"\n","And UI language switches to Spanish",(0,i.jsx)(n.br,{}),"\n","And date formats change to DD/MM/YYYY",(0,i.jsx)(n.br,{}),"\n","And number formats use European convention (1.000,50)",(0,i.jsx)(n.br,{}),"\n","And the preference is persisted"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-2-view-date-in-locale-format",children:"Scenario 2: View date in locale format"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:['Given a user has locale set to "es-ES"',(0,i.jsx)(n.br,{}),"\n","When the user views a date (e.g., event date)",(0,i.jsx)(n.br,{}),"\n",'Then dates are displayed as "15/11/2025" (DD/MM/YYYY)',(0,i.jsx)(n.br,{}),"\n",'And month names are in Spanish (e.g., "noviembre")']})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-3-view-numbers-in-locale-format",children:"Scenario 3: View numbers in locale format"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:['Given a user has locale set to "de-DE" (German - Germany)',(0,i.jsx)(n.br,{}),"\n","When the user views numeric data (e.g., weather temperature)",(0,i.jsx)(n.br,{}),"\n","Then numbers use German formatting (1.234,56)",(0,i.jsx)(n.br,{}),"\n","And decimal separator is comma",(0,i.jsx)(n.br,{}),"\n","And thousands separator is period"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-4-reject-invalid-locale",children:"Scenario 4: Reject invalid locale"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is selecting a locale",(0,i.jsx)(n.br,{}),"\n",'When the user attempts to set locale to "xx-XX" (unsupported)',(0,i.jsx)(n.br,{}),"\n","And saves preferences",(0,i.jsx)(n.br,{}),"\n","Then validation fails",(0,i.jsx)(n.br,{}),"\n",'And an error message "Locale not supported" is displayed',(0,i.jsx)(n.br,{}),"\n","And locale is not changed",(0,i.jsx)(n.br,{}),"\n","And no LocaleChanged event is published"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-5-locale-persists-across-sessions",children:"Scenario 5: Locale persists across sessions"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:['Given a user has selected locale "fr-FR"',(0,i.jsx)(n.br,{}),"\n","When the user logs out and logs back in",(0,i.jsx)(n.br,{}),"\n",'Then the locale is restored to "fr-FR"',(0,i.jsx)(n.br,{}),"\n","And the application loads with French language",(0,i.jsx)(n.br,{}),"\n","And French date/number formats"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-6-default-locale-for-new-users",children:"Scenario 6: Default locale for new users"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a new user has just registered",(0,i.jsx)(n.br,{}),"\n","When default preferences are created",(0,i.jsx)(n.br,{}),"\n",'Then locale is set to "en-US"',(0,i.jsx)(n.br,{}),"\n","And the application uses English language"]})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use i18n library (e.g., Angular i18n, react-intl, Java ResourceBundle)"}),"\n",(0,i.jsx)(n.li,{children:'Store locale as BCP 47 language tag (e.g., "en-US", "es-ES")'}),"\n",(0,i.jsx)(n.li,{children:"Validate locale against supported locale catalog"}),"\n",(0,i.jsx)(n.li,{children:"Load language resource bundles dynamically"}),"\n",(0,i.jsx)(n.li,{children:"Use locale for date formatting (DateTimeFormatter, Intl.DateTimeFormat)"}),"\n",(0,i.jsx)(n.li,{children:"Use locale for number formatting (NumberFormat, Intl.NumberFormat)"}),"\n",(0,i.jsx)(n.li,{children:"Consider implementing locale autodetection from browser settings (future)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Should the system support right-to-left (RTL) languages?"}),"\n",(0,i.jsx)(n.li,{children:"Should locale be autodetected from browser settings by default?"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"fr-pre-003-timezone-management",children:"FR-PRE-003: Timezone management"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Priority:"})," ",(0,i.jsx)(a.A,{priority:"Should Have"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),(0,i.jsx)(n.br,{}),"\n","Users should be able to select their preferred timezone for displaying dates and times. Timezone affects how timestamps\nare displayed throughout the application, ensuring times are shown in the user's local context."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User must be authenticated"}),"\n",(0,i.jsx)(n.li,{children:"UserPreferences aggregate must exist"}),"\n",(0,i.jsx)(n.li,{children:"Timezone must be valid IANA timezone identifier"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Timezone preference is updated"}),"\n",(0,i.jsx)(n.li,{children:"TimezoneChanged event is published (optional)"}),"\n",(0,i.jsx)(n.li,{children:"Timestamps displayed in selected timezone"}),"\n",(0,i.jsx)(n.li,{children:"Timezone preference persists across sessions"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Default timezone is browser-detected or UTC"}),"\n",(0,i.jsx)(n.li,{children:'Supported timezones are IANA timezone database identifiers (e.g., "America/New_York", "Europe/Madrid")'}),"\n",(0,i.jsx)(n.li,{children:"Invalid timezones are rejected with validation error"}),"\n",(0,i.jsx)(n.li,{children:"Timezone changes apply immediately"}),"\n",(0,i.jsx)(n.li,{children:"All timestamps are stored in UTC and converted for display"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Authenticated User"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-002 (User Productivity Enhancement), BR-005 (User Value\nDelivery)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Aggregates: UserPreferences (root)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Events: PreferencesUpdated, UserRegistered (consumed)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User Identity context (UserId association)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User can select timezone from searchable list"}),"\n",(0,i.jsx)(n.li,{children:"Timezone changes apply immediately"}),"\n",(0,i.jsx)(n.li,{children:"PreferencesUpdated event is published with new timezone"}),"\n",(0,i.jsx)(n.li,{children:"All timestamps display in selected timezone"}),"\n",(0,i.jsx)(n.li,{children:"Timezone preference persists across sessions"}),"\n",(0,i.jsx)(n.li,{children:"Invalid timezone selection shows error message"}),"\n",(0,i.jsx)(n.li,{children:"System displays timezone offset (e.g., UTC-5, UTC+1)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"US-PRE-003-001: Select timezone"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-003-002: View timestamps in timezone"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-003-003: Autodetect timezone from browser"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-003-004: Reject invalid timezone"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"scenarios-2",children:"Scenarios"}),"\n",(0,i.jsx)(n.h5,{id:"scenario-1-select-timezone-happy-path",children:"Scenario 1: Select timezone (happy path)"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is viewing preferences settings",(0,i.jsx)(n.br,{}),"\n",'And current timezone is "UTC"',(0,i.jsx)(n.br,{}),"\n",'When the user selects timezone "America/New_York"',(0,i.jsx)(n.br,{}),"\n","And saves preferences",(0,i.jsx)(n.br,{}),"\n",'Then the timezone preference is updated to "America/New_York"',(0,i.jsx)(n.br,{}),"\n","And a PreferencesUpdated event is published",(0,i.jsx)(n.br,{}),"\n","And all timestamps display in Eastern Time",(0,i.jsx)(n.br,{}),"\n","And timezone offset is shown (e.g., UTC-5 or UTC-4 depending on DST)",(0,i.jsx)(n.br,{}),"\n","And the preference is persisted"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-2-view-timestamps-in-timezone",children:"Scenario 2: View timestamps in timezone"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:['Given a user has timezone set to "Europe/Madrid" (UTC+1/UTC+2)',(0,i.jsx)(n.br,{}),"\n",'And an event is scheduled at "2025-11-20T10:00:00Z" (UTC)',(0,i.jsx)(n.br,{}),"\n","When the user views the event",(0,i.jsx)(n.br,{}),"\n",'Then the time is displayed as "11:00" or "12:00" (depending on DST)',(0,i.jsx)(n.br,{}),"\n","And timezone is indicated (CET or CEST)"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-3-autodetect-timezone-from-browser",children:"Scenario 3: Autodetect timezone from browser"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a new user is registering",(0,i.jsx)(n.br,{}),"\n","When default preferences are created",(0,i.jsx)(n.br,{}),"\n","Then the system detects browser timezone using Intl.DateTimeFormat().resolvedOptions().timeZone",(0,i.jsx)(n.br,{}),"\n",'And sets timezone to detected value (e.g., "America/Los_Angeles")',(0,i.jsx)(n.br,{}),"\n","And the user can change it later if needed"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-4-reject-invalid-timezone",children:"Scenario 4: Reject invalid timezone"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is selecting a timezone",(0,i.jsx)(n.br,{}),"\n",'When the user attempts to set timezone to "Invalid/Timezone"',(0,i.jsx)(n.br,{}),"\n","And saves preferences",(0,i.jsx)(n.br,{}),"\n","Then validation fails",(0,i.jsx)(n.br,{}),"\n",'And an error message "Invalid timezone" is displayed',(0,i.jsx)(n.br,{}),"\n","And timezone is not changed",(0,i.jsx)(n.br,{}),"\n","And no PreferencesUpdated event is published"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-5-timezone-persists-across-sessions",children:"Scenario 5: Timezone persists across sessions"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:['Given a user has selected timezone "Asia/Tokyo"',(0,i.jsx)(n.br,{}),"\n","When the user logs out and logs back in",(0,i.jsx)(n.br,{}),"\n",'Then the timezone is restored to "Asia/Tokyo"',(0,i.jsx)(n.br,{}),"\n","And all timestamps display in Japan Standard Time"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-6-search-timezone-by-city-name",children:"Scenario 6: Search timezone by city name"}),"\n",(0,i.jsxs)(n.admonition,{title:"gherkin",type:"note",children:[(0,i.jsxs)(n.p,{children:["Given a user is selecting timezone",(0,i.jsx)(n.br,{}),"\n",'When the user types "Madrid" in the search box',(0,i.jsx)(n.br,{}),"\n","Then matching timezones are filtered:"]}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Europe/Madrid",(0,i.jsx)(n.br,{}),"\n","And the user can select from the filtered list"]}),"\n"]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use IANA timezone database (tzdata)"}),"\n",(0,i.jsx)(n.li,{children:'Store timezone as IANA identifier (e.g., "America/New_York")'}),"\n",(0,i.jsx)(n.li,{children:"Use timezone-aware date libraries (e.g., Luxon, date-fns-tz, ZonedDateTime in Java)"}),"\n",(0,i.jsx)(n.li,{children:"Store all timestamps in UTC in database"}),"\n",(0,i.jsx)(n.li,{children:"Convert to user's timezone for display only"}),"\n",(0,i.jsx)(n.li,{children:"Handle Daylight Saving Time (DST) transitions correctly"}),"\n",(0,i.jsx)(n.li,{children:"Provide timezone search/autocomplete for better UX"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Should timezone be autodetected and updated when user travels?"}),"\n",(0,i.jsx)(n.li,{children:"Should there be quick-select common timezones?"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"fr-pre-004-default-preferences",children:"FR-PRE-004: Default preferences"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Priority:"})," ",(0,i.jsx)(a.A,{priority:"Must Have"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),(0,i.jsx)(n.br,{}),"\n","The system must create default preferences for new users when they register. Default preferences provide sensible\ninitial values that ensure the application works immediately without requiring user configuration."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"UserRegistered event is received from User Identity context"}),"\n",(0,i.jsx)(n.li,{children:"UserId is provided in the event"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"UserPreferences aggregate is created with defaults"}),"\n",(0,i.jsx)(n.li,{children:"Preferences are persisted"}),"\n",(0,i.jsx)(n.li,{children:"PreferencesCreated event is published (optional)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Default preferences are created automatically on user registration"}),"\n",(0,i.jsx)(n.li,{children:'Default theme: "System" (follows OS preference)'}),"\n",(0,i.jsx)(n.li,{children:'Default locale: "en-US" (English - United States)'}),"\n",(0,i.jsx)(n.li,{children:"Default timezone: Browser-detected or UTC"}),"\n",(0,i.jsx)(n.li,{children:"Default widget settings: Reasonable defaults per widget type"}),"\n",(0,i.jsx)(n.li,{children:"User can change defaults at any time after registration"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"System (automatic on user registration)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-002 (User Productivity Enhancement), BR-005 (User Value\nDelivery)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Aggregates: UserPreferences (root)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Events: UserRegistered (consumed), PreferencesCreated (published)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User Identity context (UserRegistered event)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"UserPreferences aggregate is created on UserRegistered event"}),"\n",(0,i.jsx)(n.li,{children:"Default values are applied for all preference fields"}),"\n",(0,i.jsx)(n.li,{children:'Theme is set to "System"'}),"\n",(0,i.jsx)(n.li,{children:'Locale is set to "en-US"'}),"\n",(0,i.jsx)(n.li,{children:"Timezone is set to browser-detected or UTC"}),"\n",(0,i.jsx)(n.li,{children:"Preferences are persisted to database"}),"\n",(0,i.jsx)(n.li,{children:"PreferencesCreated event is published"}),"\n",(0,i.jsx)(n.li,{children:"Operation is idempotent (no duplicate preferences)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"US-PRE-004-001: Create default preferences on registration"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-004-002: Verify default values"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-004-003: User can change defaults"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"scenarios-3",children:"Scenarios"}),"\n",(0,i.jsx)(n.h5,{id:"scenario-1-create-default-preferences-on-registration-happy-path",children:"Scenario 1: Create default preferences on registration (happy path)"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:['Given a new user "john_doe" has just registered',(0,i.jsx)(n.br,{}),"\n","When the system processes UserRegistered event",(0,i.jsx)(n.br,{}),"\n",'Then a UserPreferences aggregate is created for "john_doe"',(0,i.jsx)(n.br,{}),"\n",'And theme is set to "System"',(0,i.jsx)(n.br,{}),"\n",'And locale is set to "en-US"',(0,i.jsx)(n.br,{}),"\n","And timezone is set to browser-detected value (or UTC)",(0,i.jsx)(n.br,{}),"\n","And widget defaults are set (empty or reasonable values)",(0,i.jsx)(n.br,{}),"\n","And preferences are persisted to database",(0,i.jsx)(n.br,{}),"\n","And a PreferencesCreated event is published"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-2-verify-default-values",children:"Scenario 2: Verify default values"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a new user has registered",(0,i.jsx)(n.br,{}),"\n","When the user views preferences settings",(0,i.jsx)(n.br,{}),"\n",'Then theme shows "System" selected',(0,i.jsx)(n.br,{}),"\n",'And locale shows "en-US" selected',(0,i.jsx)(n.br,{}),"\n","And timezone shows detected or UTC value",(0,i.jsx)(n.br,{}),"\n","And all defaults are displayed correctly"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-3-user-can-change-defaults",children:"Scenario 3: User can change defaults"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a new user has default preferences",(0,i.jsx)(n.br,{}),"\n",'When the user changes theme to "Dark"',(0,i.jsx)(n.br,{}),"\n",'And changes locale to "es-ES"',(0,i.jsx)(n.br,{}),"\n","And saves preferences",(0,i.jsx)(n.br,{}),"\n","Then the changes are persisted",(0,i.jsx)(n.br,{}),"\n","And override the defaults",(0,i.jsx)(n.br,{}),"\n","And the application uses new values"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-4-idempotent-preference-creation",children:"Scenario 4: Idempotent preference creation"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given UserRegistered event is processed",(0,i.jsx)(n.br,{}),"\n","And UserPreferences are created",(0,i.jsx)(n.br,{}),"\n","When the event is processed again (e.g., retry)",(0,i.jsx)(n.br,{}),"\n","Then no duplicate preferences are created",(0,i.jsx)(n.br,{}),"\n","And existing preferences remain unchanged",(0,i.jsx)(n.br,{}),"\n","And no error occurs"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-5-browser-timezone-detection",children:"Scenario 5: Browser timezone detection"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:['Given a user registers from browser in "America/Los_Angeles" timezone',(0,i.jsx)(n.br,{}),"\n","When default preferences are created",(0,i.jsx)(n.br,{}),"\n",'Then timezone is detected as "America/Los_Angeles"',(0,i.jsx)(n.br,{}),"\n","And set as default timezone",(0,i.jsx)(n.br,{}),"\n","And the user sees timestamps in Pacific Time"]})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use event handler to consume UserRegistered event"}),"\n",(0,i.jsx)(n.li,{children:"Implement idempotency using userId as unique key"}),"\n",(0,i.jsxs)(n.li,{children:["Browser timezone detection: ",(0,i.jsx)(n.code,{children:"Intl.DateTimeFormat().resolvedOptions().timeZone"})]}),"\n",(0,i.jsx)(n.li,{children:"Ensure default creation is transactional"}),"\n",(0,i.jsx)(n.li,{children:"Log preference creation for audit"}),"\n",(0,i.jsx)(n.li,{children:"Consider making default values configurable (environment variables)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Should defaults vary by user region (e.g., locale detected from IP)?"}),"\n",(0,i.jsx)(n.li,{children:"Should there be organization-level default overrides (future)?"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"fr-pre-005-preference-persistence",children:"FR-PRE-005: Preference persistence"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Priority:"})," ",(0,i.jsx)(a.A,{priority:"Must Have"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),(0,i.jsx)(n.br,{}),"\n","The system must persist user preferences to ensure they survive application restarts and are available across sessions\nand devices. Persistence guarantees that user customizations are not lost."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"UserPreferences aggregate exists"}),"\n",(0,i.jsx)(n.li,{children:"Preferences have been modified"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Preferences are persisted to database"}),"\n",(0,i.jsx)(n.li,{children:"Preferences can be retrieved on subsequent access"}),"\n",(0,i.jsx)(n.li,{children:"Consistency is maintained across concurrent updates"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"All preference changes are persisted immediately"}),"\n",(0,i.jsx)(n.li,{children:"Preferences are retrieved when user logs in"}),"\n",(0,i.jsx)(n.li,{children:"Concurrent updates are handled safely (optimistic locking)"}),"\n",(0,i.jsx)(n.li,{children:"Failed persistence operations are logged and retried"}),"\n",(0,i.jsx)(n.li,{children:"Persistence must be transactional (ACID properties)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"System (automatic persistence)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-003 (Technical Excellence), BR-005 (User Value Delivery)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Aggregates: UserPreferences (root)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Events: All preference events"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Database storage"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Preference changes are persisted immediately after update"}),"\n",(0,i.jsx)(n.li,{children:"Preferences can be retrieved by UserId"}),"\n",(0,i.jsx)(n.li,{children:"Preferences persist across sessions (logout/login)"}),"\n",(0,i.jsx)(n.li,{children:"Preferences persist across application restarts"}),"\n",(0,i.jsx)(n.li,{children:"Concurrent updates are handled safely (optimistic locking)"}),"\n",(0,i.jsx)(n.li,{children:"Failed persistence operations are logged"}),"\n",(0,i.jsx)(n.li,{children:"Persistence operations are atomic"}),"\n",(0,i.jsx)(n.li,{children:"Read operations are efficient (indexed by UserId)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"US-PRE-005-001: Persist preference changes"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-005-002: Retrieve preferences on login"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-005-003: Handle concurrent updates"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-005-004: Persist across restarts"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"scenarios-4",children:"Scenarios"}),"\n",(0,i.jsx)(n.h5,{id:"scenario-1-persist-preference-changes-happy-path",children:"Scenario 1: Persist preference changes (happy path)"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:['Given a user changes theme from "Light" to "Dark"',(0,i.jsx)(n.br,{}),"\n","When the preference update is saved",(0,i.jsx)(n.br,{}),"\n","Then the preference is immediately persisted to database",(0,i.jsx)(n.br,{}),"\n","And a ThemeChanged event is published",(0,i.jsx)(n.br,{}),"\n","And persistence completes successfully"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-2-retrieve-preferences-on-login",children:"Scenario 2: Retrieve preferences on login"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user has previously set preferences (Dark theme, es-ES locale)",(0,i.jsx)(n.br,{}),"\n","When the user logs in",(0,i.jsx)(n.br,{}),"\n","Then preferences are retrieved from database by UserId",(0,i.jsx)(n.br,{}),"\n",'And theme is loaded as "Dark"',(0,i.jsx)(n.br,{}),"\n",'And locale is loaded as "es-ES"',(0,i.jsx)(n.br,{}),"\n","And application applies these preferences"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-3-handle-concurrent-updates",children:"Scenario 3: Handle concurrent updates"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user has preferences open in two browser tabs",(0,i.jsx)(n.br,{}),"\n","When the user updates theme in tab 1",(0,i.jsx)(n.br,{}),"\n","And simultaneously updates locale in tab 2",(0,i.jsx)(n.br,{}),"\n","Then optimistic locking detects the conflict",(0,i.jsx)(n.br,{}),"\n","And one operation succeeds immediately",(0,i.jsx)(n.br,{}),"\n","And the other operation is retried with updated state",(0,i.jsx)(n.br,{}),"\n","And both changes are successfully persisted",(0,i.jsx)(n.br,{}),"\n","And no data is lost"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-4-persist-across-restarts",children:"Scenario 4: Persist across restarts"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user has set preferences",(0,i.jsx)(n.br,{}),"\n","When the application is restarted",(0,i.jsx)(n.br,{}),"\n","And the user logs in",(0,i.jsx)(n.br,{}),"\n","Then preferences are loaded from persistent storage",(0,i.jsx)(n.br,{}),"\n","And all user settings are restored",(0,i.jsx)(n.br,{}),"\n","And the application applies them correctly"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-5-persistence-failure---retry",children:"Scenario 5: Persistence failure - retry"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user changes preferences",(0,i.jsx)(n.br,{}),"\n","When persistence fails due to database error",(0,i.jsx)(n.br,{}),"\n","Then the error is logged",(0,i.jsx)(n.br,{}),"\n","And the operation is queued for retry",(0,i.jsx)(n.br,{}),"\n","And the user is notified of the temporary issue",(0,i.jsx)(n.br,{}),"\n","And the system retries with exponential backoff",(0,i.jsx)(n.br,{}),"\n","And succeeds on retry"]})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Use relational database with userId as primary/foreign key"}),"\n",(0,i.jsx)(n.li,{children:"Implement optimistic locking with version field"}),"\n",(0,i.jsx)(n.li,{children:"Use database transactions for atomic updates"}),"\n",(0,i.jsx)(n.li,{children:"Index preferences table by userId for efficient retrieval"}),"\n",(0,i.jsx)(n.li,{children:"Implement retry logic with exponential backoff"}),"\n",(0,i.jsx)(n.li,{children:"Log all persistence operations for debugging"}),"\n",(0,i.jsx)(n.li,{children:"Consider caching preferences in Redis for performance (future)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Should there be preference versioning for rollback?"}),"\n",(0,i.jsx)(n.li,{children:"Should preferences be backed up separately?"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"fr-pre-006-preference-validation",children:"FR-PRE-006: Preference validation"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Priority:"})," ",(0,i.jsx)(a.A,{priority:"Must Have"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"}),(0,i.jsx)(n.br,{}),"\n","The system must validate preference values before persisting to ensure data integrity and prevent invalid\nconfigurations. Validation includes checking against supported value catalogs and format requirements."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Preconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User is updating preferences"}),"\n",(0,i.jsx)(n.li,{children:"Preference values are provided"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Postconditions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Valid preferences are accepted and persisted"}),"\n",(0,i.jsx)(n.li,{children:"Invalid preferences are rejected with error messages"}),"\n",(0,i.jsx)(n.li,{children:"Validation errors are logged"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Business rules:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Theme must be one of: Light, Dark, System"}),"\n",(0,i.jsx)(n.li,{children:"Locale must be supported (from locale catalog)"}),"\n",(0,i.jsx)(n.li,{children:"Timezone must be valid IANA identifier"}),"\n",(0,i.jsx)(n.li,{children:"All preference values must pass validation before persistence"}),"\n",(0,i.jsx)(n.li,{children:"Validation errors provide helpful error messages"}),"\n",(0,i.jsx)(n.li,{children:"Invalid updates do not modify existing preferences"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User roles:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"System (automatic validation)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Related to:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Business Requirements: BR-001 (Portfolio Enhancement), BR-003 (Technical Excellence), BR-005 (User Value Delivery)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Aggregates: UserPreferences (root)"}),"\n",(0,i.jsx)(n.li,{children:"Domain Events: None (validation only)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Dependencies:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Supported value catalogs (themes, locales, timezones)"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Acceptance criteria:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Theme values are validated against enum (Light, Dark, System)"}),"\n",(0,i.jsx)(n.li,{children:"Locale values are validated against supported locale catalog"}),"\n",(0,i.jsx)(n.li,{children:"Timezone values are validated against IANA timezone database"}),"\n",(0,i.jsx)(n.li,{children:"Invalid values are rejected with appropriate error messages"}),"\n",(0,i.jsx)(n.li,{children:"Validation occurs before persistence"}),"\n",(0,i.jsx)(n.li,{children:"Validation errors are logged"}),"\n",(0,i.jsx)(n.li,{children:"User receives clear feedback on validation failures"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"User stories:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"US-PRE-006-001: Validate theme value"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-006-002: Validate locale value"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-006-003: Validate timezone value"}),"\n",(0,i.jsx)(n.li,{children:"US-PRE-006-004: Reject multiple invalid values"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h4,{id:"scenarios-5",children:"Scenarios"}),"\n",(0,i.jsx)(n.h5,{id:"scenario-1-validate-theme-value-happy-path",children:"Scenario 1: Validate theme value (happy path)"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is updating preferences",(0,i.jsx)(n.br,{}),"\n",'When the user sets theme to "Dark"',(0,i.jsx)(n.br,{}),"\n","Then theme value is validated against enum (Light, Dark, System)",(0,i.jsx)(n.br,{}),"\n","And validation passes",(0,i.jsx)(n.br,{}),"\n","And preference is updated"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-2-reject-invalid-theme-value",children:"Scenario 2: Reject invalid theme value"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is updating preferences",(0,i.jsx)(n.br,{}),"\n",'When the user attempts to set theme to "Blue" (invalid)',(0,i.jsx)(n.br,{}),"\n","Then validation fails",(0,i.jsx)(n.br,{}),"\n",'And an error message "Invalid theme. Supported: Light, Dark, System" is displayed',(0,i.jsx)(n.br,{}),"\n","And the preference is not updated"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-3-validate-locale-value",children:"Scenario 3: Validate locale value"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is updating preferences",(0,i.jsx)(n.br,{}),"\n",'When the user sets locale to "fr-FR"',(0,i.jsx)(n.br,{}),"\n",'And "fr-FR" is in the supported locale catalog',(0,i.jsx)(n.br,{}),"\n","Then validation passes",(0,i.jsx)(n.br,{}),"\n","And preference is updated"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-4-reject-invalid-locale-value",children:"Scenario 4: Reject invalid locale value"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is updating preferences",(0,i.jsx)(n.br,{}),"\n",'When the user sets locale to "xx-XX" (unsupported)',(0,i.jsx)(n.br,{}),"\n","Then validation fails",(0,i.jsx)(n.br,{}),"\n",'And an error message "Locale not supported" is displayed',(0,i.jsx)(n.br,{}),"\n","And available locales are suggested",(0,i.jsx)(n.br,{}),"\n","And the preference is not updated"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-5-validate-timezone-value",children:"Scenario 5: Validate timezone value"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is updating preferences",(0,i.jsx)(n.br,{}),"\n",'When the user sets timezone to "America/New_York"',(0,i.jsx)(n.br,{}),"\n",'And "America/New_York" is valid IANA identifier',(0,i.jsx)(n.br,{}),"\n","Then validation passes",(0,i.jsx)(n.br,{}),"\n","And preference is updated"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-6-reject-invalid-timezone-value",children:"Scenario 6: Reject invalid timezone value"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is updating preferences",(0,i.jsx)(n.br,{}),"\n",'When the user sets timezone to "Invalid/Timezone"',(0,i.jsx)(n.br,{}),"\n","Then validation fails",(0,i.jsx)(n.br,{}),"\n",'And an error message "Invalid timezone identifier" is displayed',(0,i.jsx)(n.br,{}),"\n","And the preference is not updated"]})}),"\n",(0,i.jsx)(n.h5,{id:"scenario-7-reject-multiple-invalid-values",children:"Scenario 7: Reject multiple invalid values"}),"\n",(0,i.jsx)(n.admonition,{title:"gherkin",type:"note",children:(0,i.jsxs)(n.p,{children:["Given a user is updating multiple preferences",(0,i.jsx)(n.br,{}),"\n",'When the user sets theme to "Blue" (invalid)',(0,i.jsx)(n.br,{}),"\n",'And sets locale to "xx-XX" (invalid)',(0,i.jsx)(n.br,{}),"\n",'And sets timezone to "America/New_York" (valid)',(0,i.jsx)(n.br,{}),"\n","Then validation fails for theme and locale",(0,i.jsx)(n.br,{}),"\n","And error messages list all validation errors",(0,i.jsx)(n.br,{}),"\n","And none of the preferences are updated",(0,i.jsx)(n.br,{}),"\n","And the operation is atomic (all or nothing)"]})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Technical notes:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Implement validation at domain model level (before persistence)"}),"\n",(0,i.jsx)(n.li,{children:"Use enum for theme validation (compile-time safety)"}),"\n",(0,i.jsx)(n.li,{children:"Load supported locales from configuration file"}),"\n",(0,i.jsx)(n.li,{children:"Validate timezone using TimeZone.getAvailableIDs() or similar"}),"\n",(0,i.jsx)(n.li,{children:"Provide detailed validation error messages"}),"\n",(0,i.jsx)(n.li,{children:"Log validation failures with context"}),"\n",(0,i.jsx)(n.li,{children:"Consider implementing custom validators for extensibility"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Open questions:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Should validation be client-side only, server-side only, or both?"}),"\n",(0,i.jsx)(n.li,{children:"Should there be validation warnings in addition to errors?"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"cross-feature-considerations",children:"Cross-feature considerations"}),"\n",(0,i.jsx)(n.h3,{id:"interactions-between-features",children:"Interactions between features"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Theme Management \u2194 Preference Persistence:"})," Theme changes are immediately persisted"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Locale Management \u2194 Preference Persistence:"})," Locale changes are immediately persisted"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Timezone Management \u2194 Preference Persistence:"})," Timezone changes are immediately persisted"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Default Preferences \u2194 All Features:"})," Defaults initialize all preference fields on registration"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Preference Validation \u2194 All Features:"})," Validation applies to all preference updates"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"All Features \u2194 Event Publishing:"})," Preference changes publish events to downstream contexts"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"shared-business-rules",children:"Shared business rules"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"User Scoping:"})," All preferences belong to exactly one user"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Atomicity:"})," All preference updates must be atomic (all or nothing)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validation:"})," All preference values must be validated before persistence"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Immediate Effect:"})," All preference changes apply immediately without page reload"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Persistence:"})," All preferences must persist across sessions"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Event Publishing:"})," Preference changes must publish events after successful persistence"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"data-consistency-requirements",children:"Data consistency requirements"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Strong Consistency:"})," Preference updates require strong consistency"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Transactional Boundaries:"})," UserPreferences aggregate is the transactional boundary"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Event Publishing:"})," Events must be published after successful persistence (transactional outbox pattern)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Optimistic Locking:"})," Concurrent updates must use optimistic locking to prevent conflicts"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Default Creation:"})," Default preference creation must be idempotent"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"business-constraints-impact",children:"Business constraints impact"}),"\n",(0,i.jsx)(n.h3,{id:"bc-001-budget",children:"BC-001: Budget"}),"\n",(0,i.jsx)(n.p,{children:"Preferences management must operate within zero-cost infrastructure constraints:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Storage:"})," Use free-tier database (PostgreSQL) for preference storage"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Caching:"})," Use in-memory cache initially (no paid Redis required)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Event Publishing:"})," Use local event bus initially (no paid message queue)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validation:"})," Use local validation (no external validation services)"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"bc-002-timeline",children:"BC-002: Timeline"}),"\n",(0,i.jsx)(n.p,{children:"Preferences management is on critical path for MVP (3-6 months):"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Must Have features"})," (FR-PRE-001, 004, 005, 006) required for MVP"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Should Have features"})," (FR-PRE-002, 003) enhance UX but can be simplified"]}),"\n",(0,i.jsx)(n.li,{children:"Prioritize theme management and default preferences"}),"\n",(0,i.jsx)(n.li,{children:"Defer advanced locale/timezone features to post-MVP if needed"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"bc-003-resources",children:"BC-003: Resources"}),"\n",(0,i.jsx)(n.p,{children:"Single-developer constraints affect Preferences management:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Simplify Locale:"})," Start with English only, add more languages incrementally"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Simplify Timezone:"})," Autodetect from browser, allow manual change later"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Automate Testing:"})," Heavy investment in validation tests"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Incremental Development:"})," Build theme first, then defaults, then locale/timezone"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"bc-004-technology-stack",children:"BC-004: Technology stack"}),"\n",(0,i.jsx)(n.p,{children:"Preferences management aligns with chosen stack:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Backend:"})," Spring Boot REST APIs for preference CRUD"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Database:"})," PostgreSQL for preference storage"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Events:"})," Spring Events initially; design for future Kafka/RabbitMQ migration"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Validation:"})," Bean Validation (JSR-303) for preference validation"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Frontend:"})," Angular components for preference UI, reactive forms"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Caching:"})," Spring Cache abstraction with Caffeine (in-memory)"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"success-metrics-alignment",children:"Success metrics alignment"}),"\n",(0,i.jsx)(n.p,{children:"Preferences management contributes to the following success metrics from BR-001 through BR-008:"}),"\n",(0,i.jsx)(n.h3,{id:"br-003-technical-metrics",children:"BR-003: Technical metrics"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Metric"}),(0,i.jsx)(n.th,{children:"Target"}),(0,i.jsx)(n.th,{children:"Preferences contribution"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"API Response Time"})}),(0,i.jsx)(n.td,{children:"< 200ms (p95)"}),(0,i.jsx)(n.td,{children:"Fast preference retrieval, efficient caching"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Test Coverage"})}),(0,i.jsx)(n.td,{children:"> 80%"}),(0,i.jsx)(n.td,{children:"Comprehensive validation tests for all FR-PRE features"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"br-001-portfolio-quality-metrics",children:"BR-001: Portfolio quality metrics"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Metric"}),(0,i.jsx)(n.th,{children:"Target"}),(0,i.jsx)(n.th,{children:"Preferences contribution"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Architecture Documentation"})}),(0,i.jsx)(n.td,{children:"All views complete"}),(0,i.jsx)(n.td,{children:"Preferences aggregate design, cross-cutting concerns"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Code Quality Score"})}),(0,i.jsx)(n.td,{children:"No critical issues"}),(0,i.jsx)(n.td,{children:"Clean preference management, proper validation"})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"br-002-br-005-user-experience-metrics",children:"BR-002, BR-005: User experience metrics"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Metric"}),(0,i.jsx)(n.th,{children:"Target"}),(0,i.jsx)(n.th,{children:"Preferences contribution"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Task Completion Rate"})}),(0,i.jsx)(n.td,{children:"> 95%"}),(0,i.jsx)(n.td,{children:"Simple preference UI, clear theme/locale selection"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Mobile Usability"})}),(0,i.jsx)(n.td,{children:"Fully Responsive"}),(0,i.jsx)(n.td,{children:"Responsive preference forms, touch-friendly controls"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Accessibility Score"})}),(0,i.jsx)(n.td,{children:"WCAG 2.1 Level AA"}),(0,i.jsx)(n.td,{children:"Accessible preference UI, clear labels and feedback"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"User Satisfaction"})}),(0,i.jsx)(n.td,{children:"> 4.0/5.0"}),(0,i.jsx)(n.td,{children:"Personalized experience, immediate theme changes"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"traceability-matrix",children:"Traceability matrix"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Feature"}),(0,i.jsx)(n.th,{children:"Business Req"}),(0,i.jsx)(n.th,{children:"Domain Events"}),(0,i.jsx)(n.th,{children:"User Stories"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-001"}),(0,i.jsx)(n.td,{children:"BR-001, BR-002, BR-005"}),(0,i.jsx)(n.td,{children:"ThemeChanged, UserRegistered"}),(0,i.jsx)(n.td,{children:"US-PRE-001-001/002/003/004"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-002"}),(0,i.jsx)(n.td,{children:"BR-001, BR-002, BR-005"}),(0,i.jsx)(n.td,{children:"LocaleChanged, UserRegistered"}),(0,i.jsx)(n.td,{children:"US-PRE-002-001/002/003/004"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-003"}),(0,i.jsx)(n.td,{children:"BR-001, BR-002, BR-005"}),(0,i.jsx)(n.td,{children:"PreferencesUpdated, UserRegistered"}),(0,i.jsx)(n.td,{children:"US-PRE-003-001/002/003/004"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-004"}),(0,i.jsx)(n.td,{children:"BR-001, BR-002, BR-005"}),(0,i.jsx)(n.td,{children:"PreferencesCreated, UserRegistered (consumed)"}),(0,i.jsx)(n.td,{children:"US-PRE-004-001/002/003"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-005"}),(0,i.jsx)(n.td,{children:"BR-001, BR-003, BR-005"}),(0,i.jsx)(n.td,{children:"All preference events"}),(0,i.jsx)(n.td,{children:"US-PRE-005-001/002/003/004"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"FR-PRE-006"}),(0,i.jsx)(n.td,{children:"BR-001, BR-003, BR-005"}),(0,i.jsx)(n.td,{children:"None (validation only)"}),(0,i.jsx)(n.td,{children:"US-PRE-006-001/002/003/004"})]})]})]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(j,{...e})}):j(e)}},6453:(e,n,s)=>{s.d(n,{A:()=>l});const r={priorityLabel:"priorityLabel_hNWY",priorityLabelMustHave:"priorityLabelMustHave_fw2O",priorityLabelShouldHave:"priorityLabelShouldHave_iftn",priorityLabelCouldHave:"priorityLabelCouldHave_Pzg7",priorityLabelWontHave:"priorityLabelWontHave_d7BD"};var i=s(7259);function t(e){const n=e.replaceAll(" ","").replaceAll("'","");return r.priorityLabel+" "+r[`priorityLabel${n}`]}function l(e){return(0,i.jsx)("span",{className:t(e.priority),children:e.priority||"-"})}}}]);